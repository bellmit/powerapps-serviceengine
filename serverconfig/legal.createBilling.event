<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<event transactional="true" type="event">
 <exec count="1" type="createlist"/>
 <exec ceiling="false" endmonth="false" nextweekday="false" startmonth="false" to="CURRENT_TIME" truncate="false" type="date"/>
 <exec to="LOGON_USER" type="user"/>
 <exec message="PS" target="STAGE_CODE" type="formattext"/>
 <exec from="CURRENT_TIME" key="CURRENT_TIME" to="INVOICE_LIST" type="copyintolist"/>
 <exec from="STAGE_CODE" key="STAGE_CODE" to="INVOICE_LIST" type="copyintolist"/>
 <exec from="LOGON_USER" key="LOGON_USER" to="INVOICE_LIST" type="copyintolist"/>
 <exec argument="INVOICE_LIST" type="loop">
  <exec type="guard">
   <conditions>
    <condition lhsfield="REMARKS" operator="is empty" rhsvalue=""/>
   </conditions>
   <exec message="Created via Create Billing" target="REMARKS" type="formattext"/>
  </exec>
  <exec statement="createLegalInvoice" type="insert"/>
  <exec from="ID" key="INVOICE_ID" to="TRANSACTIONS" type="copyintolist"/>
  <exec from="ID" to="INVOICE_ID" type="copy"/>
  <exec argument="TRANSACTIONS" type="loop">
   <exec recordcount="" statement="updateInvoiceTransactionRel" type="update"/>
  </exec>
  <exec statement="insertBillingHistory" type="insert"/>
 </exec>
 <exec message="Billing created" target="MESSAGE" type="formattext"/>
 <exec from="MESSAGE" key="MESSAGE" type="copyintolist"/>
 <exec from="TRUE" key="CLOSE" type="copyintolist"/>
 <exec from="TRUE" key="OPEN_MESSAGE" type="copyintolist"/>
</event>
