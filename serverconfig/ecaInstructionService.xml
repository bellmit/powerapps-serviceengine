<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="ecaInstructionService">

	<resultMap id="getEcaInstructionDetails" class="hmap">
		<result property="HEADER_TITLE" javaType="string" />
	</resultMap>
	<select id="getEcaInstructionDetails" resultMap="getEcaInstructionDetails">
		select R.DESCRIPTION FROM PTRINSTRUCTED_ACTION_REF R
		WHERE ID=#ACTION_ID#
	</select>
	
	<update id="updateEcaLastInstruction">		
		UPDATE PTRACCOUNT_AGENCY_ASSIGNMENT SET LAST_ECA_INSTRUCTION_ACTION_ID = #ACTION_ID#, LAST_ECA_INSTRUCTION_DATE = #CURRENT_TIME#
		WHERE ID= #AGENCY_ASSIGNMENT_ID#
	</update>
	<insert id="insertEcaInstruction">
		INSERT INTO PTRACCOUNT_ASSIGNMENT_INSTRUCTED_ACTION (AGENCY_ASSIGNMENT_ID,ACTION_ID,REMARKS,CREATED_BY,CREATED_TIME)
		VALUES (#AGENCY_ASSIGNMENT_ID#,#ACTION_ID#,#REMARKS#,#LOGON_USER#,#CURRENT_TIME#)
	</insert>
</sqlMap>