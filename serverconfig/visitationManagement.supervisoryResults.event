<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<event transactional="false" type="event">
 <exec argument="ACCOUNT_LIST" query="getVmsAccountIds" type="query"/>
 <exec size="999" source="ACCOUNT_LIST" target="DIVIDED_ACCOUNT_LIST" type="dividelist"/>
 <exec type="guard">
  <conditions>
   <condition lhsfield="INSTRUCTION_TYPE_ID" operator="=" rhsvalue="1"/>
  </conditions>
  <exec argument="DIVIDED_ACCOUNT_LIST" type="loop">
   <exec from="ACCOUNT_LIST" key="ACCOUNT_ID" to="ACCOUNTS" type="extract"/>
   <exec from="ACCOUNT_LIST" key="CUSTOMER_ID" to="CUSTOMERS" type="extract"/>
   <exec from="ACCOUNT_LIST" key="TREATMENT_ID" to="TREATMENTS" type="extract"/>
   <exec argument="RESULT_LIST" query="getVmsAccountDetails" type="query"/>
   <exec argument="VISUAL_LIST" query="getVmsVisualResults" type="query"/>
   <exec from="VISUAL_LIST" key="ACCOUNT_ID" to="RESULT_LIST" type="merge"/>
  </exec>
 </exec>
 <exec type="guard">
  <conditions>
   <condition lhsfield="INSTRUCTION_TYPE_ID" operator="=" rhsvalue="2"/>
  </conditions>
  <exec argument="DIVIDED_ACCOUNT_LIST" type="loop">
   <exec from="ACCOUNT_LIST" key="ACCOUNT_ID" to="ACCOUNTS" type="extract"/>
   <exec from="ACCOUNT_LIST" key="CUSTOMER_ID" to="CUSTOMERS" type="extract"/>
   <exec from="ACCOUNT_LIST" key="TREATMENT_ID" to="TREATMENTS" type="extract"/>
   <exec argument="RESULT_LIST" query="getVmsVisitationTreatments" type="query"/>
   <exec argument="ADDRESS_LIST" query="getVmsVisitationAddress" type="query"/>
   <exec argument="ACCOUNT_INFO" query="getVmsAccountDetails" type="query"/>
   <exec from="ACCOUNT_INFO" key="ACCOUNT_ID" to="RESULT_LIST" type="merge"/>
   <exec from="ADDRESS_LIST" key="TREATMENT_ID" to="RESULT_LIST" type="merge"/>
  </exec>
 </exec>
 <exec type="guard">
  <conditions>
   <condition lhsfield="INSTRUCTION_TYPE_ID" operator="=" rhsvalue="3"/>
  </conditions>
  <exec argument="DIVIDED_ACCOUNT_LIST" type="loop">
   <exec from="ACCOUNT_LIST" key="ACCOUNT_ID" to="ACCOUNTS" type="extract"/>
   <exec from="ACCOUNT_LIST" key="CUSTOMER_ID" to="CUSTOMERS" type="extract"/>
   <exec from="ACCOUNT_LIST" key="TREATMENT_ID" to="TREATMENTS" type="extract"/>
   <exec argument="RESULT_LIST" query="getVmsPacTreatments" type="query"/>
   <exec argument="ACCOUNT_INFO" query="getVmsAccountDetails" type="query"/>
   <exec argument="ADDRESS_LIST" query="getVmsHostMailingAddress" type="query"/>
   <exec from="ACCOUNT_INFO" key="ACCOUNT_ID" to="RESULT_LIST" type="merge"/>
   <exec from="ADDRESS_LIST" key="ACCOUNT_ID" to="RESULT_LIST" type="merge"/>
  </exec>
 </exec>
 <exec from="DIVIDED_ACCOUNT_LIST" key="RESULT_LIST" to="RESULT_LIST" type="extract"/>
</event>
