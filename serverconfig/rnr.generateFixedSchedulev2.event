<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<event transactional="false" type="event">
 <exec count="1" type="createlist"/>
 <exec from="TRUE" key="TRUE" type="copyintolist"/>
 <exec from="IMPLEMENTED_DATE" key="IMPLEMENTED_DATE" type="copyintolist"/>
 <exec from="FINALIZED_SETTLEMENT_AMOUNT" key="SETTLEMENT_AMOUNT" type="copyintolist"/>
 <exec from="GENERATED_SCHEDULEx" key="GENERATED_SCHEDULEx" type="copyintolist"/>
 <exec from="INTEREST_RATE" key="INTEREST_RATE" type="copyintolist"/>
 <exec from="INSTALLMENT_DUE_DAY" key="INSTALLMENT_DUE_DAY" type="copyintolist"/>
 <exec type="guard">
  <conditions>
   <condition lhsfield="TENURE" operator="is not empty" rhsvalue=""/>
  </conditions>
  <exec lhs="FINALIZED_SETTLEMENT_AMOUNT" rhs="TENURE" target="INSTALLMENT_AMOUNT" type="divide"/>
 </exec>
 <exec from="INSTALLMENT_AMOUNT" key="INSTALLMENT_AMOUNT" type="copyintolist"/>
 <exec type="loop">
  <exec count="1" to="UNIQUE_GENERATED_SCHEDULE" type="createlist"/>
  <exec from="INTEREST_RATE" key="INTEREST_RATE" to="UNIQUE_GENERATED_SCHEDULE" type="copyintolist"/>
  <exec from="INSTALLMENT_DUE_DAY" key="INSTALLMENT_DUE_DAY" to="UNIQUE_GENERATED_SCHEDULE" type="copyintolist"/>
  <exec from="SETTLEMENT_AMOUNT" key="SETTLEMENT_AMOUNT" to="UNIQUE_GENERATED_SCHEDULE" type="copyintolist"/>
  <exec from="IMPLEMENTED_DATE" key="FROM_DATE" to="UNIQUE_GENERATED_SCHEDULE" type="copyintolist"/>
  <exec from="INSTALLMENT_AMOUNT" key="INSTALLMENT_AMOUNT" to="UNIQUE_GENERATED_SCHEDULE" type="copyintolist"/>
  <exec type="guard">
   <conditions>
    <condition lhsfield="UNIQUE_GENERATED_SCHEDULE" operator="is not empty" rhsvalue=""/>
   </conditions>
   <exec from="UNIQUE_GENERATED_SCHEDULE" to="110_LIST" type="copy"/>
   <exec from="UNIQUE_GENERATED_SCHEDULE" to="200_LIST" type="copy"/>
   <exec argument="110_LIST" type="loop">
    <exec from="FROM_DATE" to="DATE" type="copy"/>
    <exec from="INSTALLMENT_AMOUNT" to="RATE" type="copy"/>
    <exec message="P" target="POST" type="formattext"/>
    <exec from="INSTALLMENT_DUE_DAY" to="BILLING_CYCLE" type="copy"/>
    <exec statement="getDecimalConversion" type="select"/>
   </exec>
   <exec argument="200_LIST" type="loop">
    <exec from="FROM_DATE" to="DATE" type="copy"/>
    <exec from="INTEREST_RATE" to="RATE" type="copy"/>
    <exec message="P" target="POST" type="formattext"/>
    <exec from="INSTALLMENT_DUE_DAY" to="BILLING_CYCLE" type="copy"/>
    <exec statement="getDecimalConversion" type="select"/>
   </exec>
   <exec message="RM" target="COMMODITY" type="formattext"/>
   <exec statement="getDecimalSettlementAmountConversion" type="select"/>
   <exec type="transaction">
    <exec commodity="COMMODITY" entrycycle="BILLING_CYCLE" entrydate="DATE" entrylist110="110_LIST" entrylist200="200_LIST" entrypost="POST" entryrate="RATE" principal="SETTLEMENT_AMOUNT" start="IMPLEMENTED_DATE" target="GENERATED_SCHEDULE" type="loanscheduleprojection"/>
   </exec>
   <exec statement="selectOne" type="select"/>
   <exec from="NEGATIVE_ONE" key="NEGATIVE_ONE" to="GENERATED_SCHEDULE" type="copyintolist"/>
   <exec argument="GENERATED_SCHEDULE" index="ROW_NUM" type="loop">
    <exec from="PERIOD_START_DATE" to="INSTALLMENT_START_DATE" type="copy"/>
    <exec from="DATE" to="INSTALLMENT_END_DATE" type="copy"/>
    <exec lhs="PRINCIPAL_DUE_AMOUNT" rhs="PRINCIPAL_REMAINING" target="OPENING_PRINCIPAL" type="add"/>
    <exec type="guard">
     <conditions>
      <condition lhsfield="ROW_NUMx" operator="=" rhsvalue="1"/>
     </conditions>
     <exec adddays="NEGATIVE_ONE" ceiling="false" endmonth="false" from="INSTALLMENT_START_DATE" nextweekday="false" startmonth="false" to="INSTALLMENT_START_DATE" truncate="false" type="date"/>
    </exec>
   </exec>
  </exec>
  <exec type="nullify">
   <key value="GENERATE"/>
  </exec>
 </exec>
</event>
