<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="camRnrService">


	<resultMap class="hmap" id="getCamRnrAccountType">
		<result property="PRODUCT_TYPE_CATEGORY" javaType="string" />
		<result property="IS_ISLAMIC" javaType="string" />
	</resultMap>

	<select id="getCamRnrAccountType" resultMap="getCamRnrAccountType">
		select ptc.code, sp.code from ptraccount a
		inner join ptrproduct_type_ref p on p.id=a.product_type_id
		inner join ptrproduct_type_category_ref ptc on ptc.id=p.category_id
		inner join ptrsptf_type_ref sp on sp.id=a.sptf_type_id
		where a.ID=#ACCOUNT_ID#
	</select>

	<resultMap id="getCamRnrLatestTreatment" class="hmap">
		<result property="TREATMENT_ID" javaType="long" />
		<result property="IS_RNR" javaType="boolean" />
	</resultMap>

	<select id="getCamRnrLatestTreatment" resultMap="getCamRnrLatestTreatment"
		parameterClass="map">
		SELECT max(TREATMENT_ID), true FROM PTRRANDR_ACC_TREATMENT_REL where
		ACCOUNT_ID = #ACCOUNT_ID:NUMERIC#
	</select>

	<resultMap class="hmap" id="getCamRnrSchedule">
		<result property="INSTALLMENT_START_DATE" javaType="date" />
		<result property="INSTALLMENT_END_DATE" javaType="date" />
		<result property="INSTALLMENT_AMOUNT" javaType="double" />
		<result property="OPENING_PRINCIPAL" javaType="double" />
		<result property="INTEREST_AMOUNT" javaType="double" />
		<result property="PRINCIPAL_REMAINING" javaType="double" />
	</resultMap>
	<select id="getCamRnrSchedule" resultMap="getCamRnrSchedule">
		SELECT INSTALLMENT_START_DATE, INSTALLMENT_END_DATE, INSTALLMENT_AMOUNT,
		OPENING_PRINCIPAL, INTEREST_AMOUNT,PRINCIPAL_REMAINING
		FROM PTRTREATMENT_RNR_SCHEDULE
		where TREATMENT_ID = #TREATMENT_ID#
	</select>

	<resultMap class="hmap" id="getCamRnrTreatmentInformation">
		<result property="TREATMENT_PROCESS_ID1" javaType="long" />
		<result property="CUSTOMER_REQUEST_DATE1" javaType="date" />
		<result property="CUSTOMER_REQUEST_RECEIVED_DATE1" javaType="date" />
		<result property="PROCESS_SUBTYPE_ID1" javaType="long" />
		<result property="COLLECTION_CENTRE_ID1" javaType="long" />

		<result property="SHORTFALL1" javaType="string" />
		<result property="PARTIAL_WRITTEN_OFF1" javaType="string" />
		<result property="PARTIAL_WRITTEN_OFF_DATE1" javaType="date" />
		<result property="WORKLIST_TYPE_ID1" javaType="long" />
		<result property="CURRENT_NO_OF_TIME_IN_RNR1" javaType="long" />

		<result property="PREVIOUS_RNR_APPROVED_DATE1" javaType="date" />
		<result property="DURATION_FROM_PREVIOUS_RNR1" javaType="string" />
		<result property="PREVIOUS_NO_OF_TIME_REPORTED_AS_RNR1"
			javaType="long" />
		<result property="INCOME_EVIDENCE1" javaType="boolean" />
		<result property="INCOME_EVIDENCE_REMARKS1" javaType="string" />

		<result property="RNR_REASON_ID1" javaType="long" />
		<result property="OTHER_RNR_REASON_REMARKS1" javaType="string" />
		<result property="NET_INCOME1" javaType="$" />
		<result property="OTHER_INCOME1" javaType="$" />
		<result property="TOTAL_INCOME1" javaType="$" />

		<result property="TOTAL_HOUSEHOLD_EXPENDITURES1" javaType="$" />
		<result property="TOTAL_FINANCIAL_COMMITMENTS1" javaType="$" />
		<result property="AMOUNT_TO_PAY_THE_BANK1" javaType="$" />
		<result property="DEBT_SERVICE_RATIO1" javaType="$" />
		<result property="REASON_OF_DEFAULT1" javaType="string" />

		<result property="YEAR_OF_FUNDED1" javaType="string" />
		<result property="SYSTEM_COMPUTATION_BREAKDOWN_TOTAL1"
			javaType="$" />
		<result property="SYSTEM_TOTAL_PROPOSED_PAYMENT_SUM1" javaType="$" />
		<result property="SYSTEM_COMPUTATION_WAIVER_TOTAL1" javaType="$" />
		<result property="JUDGEMENT_BREAKDOWN_TOTAL1" javaType="$" />

		<result property="JUDGEMENT_PAYMENT_SUM_TOTAL1" javaType="$" />
		<result property="JUDGEMENT_WAIVER_TOTAL1" javaType="$" />
		<result property="SETTLEMENT_AMOUNT1" javaType="$" />
		<result property="WITH_FURTHER_INTEREST1" javaType="boolean" />
		<result property="UPFRONT_PAYMENT1" javaType="$" />

		<result property="PDC_REQUIRED1" javaType="boolean" />
		<result property="PDC_REMARKS1" javaType="string" />
		<result property="REVIEW_DATE1" javaType="date" />
		<result property="FIRST_PAYMENT_DUE_DATE1" javaType="date" />
		<result property="NEXT_PAYMENT_DUE_DATE1" javaType="date" />

		<result property="LATE_CHARGES1" javaType="$" />
		<result property="APPROVED_DATE1" javaType="date" />
		<result property="REJECTED_DATE1" javaType="date" />
		<result property="IMPLEMENTED_DATE1" javaType="date" />
		<result property="APPROVING_AUTHORITY_ID1" javaType="string" />

		<result property="REJECTED_REASON1" javaType="string" />
		<result property="SLO_ACCEPTANCE_DATE1" javaType="date" />
		<result property="FIRST_INSTALLMENT_RECEIVED_DATE1" javaType="date" />
		<result property="CANCEL_RNR_DATE1" javaType="date" />
		<result property="CANCEL_REASON1" javaType="string" />

		<result property="PHOTOCOPY_OF_IC1" javaType="boolean" />
		<result property="LPI1" javaType="$" />
		<result property="HQ_MANAGER_REMARKS1" javaType="string" />
		<result property="TEAM_MANAGER_REMARKS1" javaType="string" />
		<result property="TEAM_LEADER_REMARKS1" javaType="string" />

		<result property="BASIS_OF_RECOMMENDATION1" javaType="string" />
	</resultMap>

	<select id="getCamRnrTreatmentInformation" resultMap="getCamRnrTreatmentInformation">
		select
		c.TREATMENT_ID,
		c.CUSTOMER_REQUEST_DATE,
		c.CUSTOMER_REQUEST_RECEIVED_DATE,
		c.SUBTYPE_ID,
		c.COLLECTION_CENTRE_ID,

		c.SHORTFALL,
		c.PARTIAL_WRITTEN_OFF,
		c.PARTIAL_WRITTEN_OFF_DATE,
		c.WORKLIST_TYPE_ID,
		c.CURRENT_NO_OF_TIME_IN_RNR,

		c.PREVIOUS_RNR_APPROVED_DATE,
		c.DURATION_FROM_PREVIOUS_RNR,
		c.PREVIOUS_NO_OF_TIME_REPORTED_AS_RNR,
		c.INCOME_EVIDENCE,
		c.INCOME_EVIDENCE_REMARKS,

		c.RNR_REASON_ID,
		c.OTHER_RNR_REASON_REMARKS,
		c.NET_INCOME,
		c.OTHER_INCOME,
		c.TOTAL_INCOME,

		c.TOTAL_HOUSEHOLD_EXPENDITURES,
		c.TOTAL_FINANCIAL_COMMITMENTS,
		c.AMOUNT_TO_PAY_THE_BANK,
		c.DEBT_SERVICE_RATIO,
		c.REASON_OF_DEFAULT,

		c.YEAR_OF_FUNDED,
		c.SYSTEM_COMPUTATION_BREAKDOWN_TOTAL,
		c.SYSTEM_TOTAL_PROPOSED_PAYMENT_SUM,
		c.SYSTEM_COMPUTATION_WAIVER_TOTAL,
		c.JUDGEMENT_BREAKDOWN_TOTAL,

		c.JUDGEMENT_PAYMENT_SUM_TOTAL,
		c.JUDGEMENT_WAIVER_TOTAL,
		c.SETTLEMENT_AMOUNT,
		c.WITH_FURTHER_INTEREST,
		c.UPFRONT_PAYMENT,

		c.PDC_REQUIRED,
		c.PDC_REMARKS,
		c.REVIEW_DATE,
		c.FIRST_PAYMENT_DUE_DATE,
		c.NEXT_PAYMENT_DUE_DATE,

		c.LATE_CHARGES,
		c.APPROVED_DATE,
		c.REJECTED_DATE,
		c.IMPLEMENTED_DATE,
		r.description,

		c.REJECTED_REASON,
		c.SLO_ACCEPTANCE_DATE,
		c.FIRST_INSTALLMENT_RECEIVED_DATE,
		c.CANCEL_RNR_DATE,
		c.CANCEL_REASON,

		c.PHOTOCOPY_OF_IC,
		c.LPI,
		c.HQ_MANAGER_REMARKS,
		c.TEAM_MANAGER_REMARKS,
		c.TEAM_LEADER_REMARKS,

		c.BASIS_OF_RECOMMENDATION
		FROM PTRTREATMENT_RNR c
		left join PTRRNR_APPROVAL_AUTHORITY_REF r on c.APPROVING_AUTHORITY_ID=r.id
		where c.TREATMENT_ID = #TREATMENT_ID#
	</select>

	<resultMap class="hmap" id="getCamRnrApprovedSchedule">
		<result property="INSTALLMENT_START_DATE" javaType="date" />
		<result property="INSTALLMENT_END_DATE" javaType="date" />
		<result property="INSTALLMENT_AMOUNT" javaType="$" />
		<result property="OPENING_PRINCIPAL" javaType="$" />
		<result property="INTEREST_AMOUNT" javaType="$" />
		<result property="PRINCIPAL_REMAINING" javaType="$" />
	</resultMap>

	<select id="getCamRnrApprovedSchedule" resultMap="getCamRnrApprovedSchedule">
		select INSTALLMENT_START_DATE,INSTALLMENT_END_DATE,
		INSTALLMENT_AMOUNT,OPENING_PRINCIPAL,INTEREST_AMOUNT,PRINCIPAL_REMAINING
		from PTRTREATMENT_RNR_SCHEDULE
		where TREATMENT_ID=#TREATMENT_ID# order by INSTALLMENT_START_DATE asc
	</select>

	<resultMap class="hmap" id="getCamRnrRemarks">
		<result property="REMARKS" javaType="string" />
	</resultMap>

	<select id="getCamRnrRemarksOth" resultMap="getCamRnrRemarks">
		select REMARKS FROM PTRTREATMENT_RNR_REMARKS where
		TREATMENT_ID=#TREATMENT_ID# and TYPE_CODE='OTH'
	</select>

	<resultMap id="getCamRnrLatestDebtCrystalization" class="hmap">
		<result property="TREATMENT_ID" javaType="long" />
		<result property="IS_DEBT_CRYSTALIZATION" javaType="boolean" />
	</resultMap>

	<select id="getCamRnrLatestDebtCrystalization" resultMap="getCamRnrLatestDebtCrystalization"
		parameterClass="map">
		SELECT max(TREATMENT_ID), true FROM PTRRNR_DEBTCRYSTALIZATION where
		ACCOUNT_ID = #ACCOUNT_ID:NUMERIC#
	</select>

	<resultMap class="hmap" id="getCamRnrDebtCrystalization">
		<result property="CF_MIA" javaType="int" />
		<result property="CF_INSTALLMENT_AMOUNT" javaType="$" />
		<result property="CF_LATE_CHARGES" javaType="$" />
		<result property="CF_ACCRUED_INTEREST" javaType="$" />
		<result property="CF_ACCRUED_LATE_CHARGE" javaType="$" />

		<result property="CF_MEMO_LATE_CHARGE" javaType="$" />
		<result property="CF_MISC_CHARGES" javaType="$" />
		<result property="CF_OTHER_CHARGES" javaType="$" />
		<result property="CF_OUTSTANDING_BALANCE" javaType="$" />
	</resultMap>
	<select id="getCamRnrDebtCrystalization" resultMap="getCamRnrDebtCrystalization">
		SELECT
		CF_MIA,
		CF_INSTALLMENT_AMOUNT,
		CF_LATE_CHARGES,CF_ACCRUED_INTEREST,
		CF_ACCRUED_LATE_CHARGE,
		CF_MEMO_LATE_CHARGE,

		CF_MISC_CHARGES,
		CF_OTHER_CHARGES,
		CF_OUTSTANDING_BALANCE
		FROM PTRRNR_DEBTCRYSTALIZATION
		WHERE TREATMENT_ID = #TREATMENT_ID#
	</select>


	<resultMap id="getCamInitiateRnrLatestTreatment" class="hmap">
		<result property="TREATMENT_ID" javaType="long" />
		<result property="IS_INITIATE_RNR" javaType="boolean" />
	</resultMap>

	<select id="getCamInitiateRnrLatestTreatment" resultMap="getCamInitiateRnrLatestTreatment"
		parameterClass="map">
		SELECT max(TREATMENT_ID), true FROM ptrtreatment_initiate_rnr where
		ACCOUNT_ID = #ACCOUNT_ID:NUMERIC#
	</select>


	<resultMap class="hmap" id="getCamInitiateRnr">
		<result property="TOTAL_BALANCE_11" javaType="$" />
		<result property="TOTAL_BALANCE_21" javaType="$" />
		<result property="GRAND_TOTAL1" javaType="$" />
		<result property="CONNECTED_PARTY_ID1" javaType="boolean" />
		<result property="CTOS1" javaType="string" />
	</resultMap>
	<select id="getCamInitiateRnr" resultMap="getCamInitiateRnr">
		select
		TOTAL_BALANCE_1,
		TOTAL_BALANCE_2,
		GRAND_TOTAL,
		CONNECTED_PARTY_ID,
		CTOS
		from
		PTRTREATMENT_INITIATE_RNR
		where TREATMENT_ID=#TREATMENT_ID#
	</select>


	<resultMap id="getCamRnrNoticeHistory" class="hmap">
		<result property="ACCOUNT_ID" javaType="long" />
		<result property="RANDR_MIA" javaType="long" />
		<result property="RANDR_DIA" javaType="long" />
		<result property="RANDR_INSTALLMENT_IN_ARREARS" javaType="long" />
		<result property="RANDR_ACCRUED_LATE_CHARGE" javaType="long" />
		<result property="RANDR_MISC_CHARGES" javaType="long" />
		<result property="RANDR_OUTSTANDING_BALANCE" javaType="long" />
		<result property="RANDR_LATE_CHARGES" javaType="long" />
		<result property="RANDR_MEMO_LATE_CHARGE" javaType="long" />
		<result property="RANDR_OTHER_CHARGES" javaType="long" />
		<result property="RANDR_TOTAL_DUE" javaType="long" />
	</resultMap>

	<select id="getCamRnrNoticeHistory" resultMap="getCamRnrNoticeHistory"
		parameterClass="map">
		select a.ID,
		<include refid="rnrMonthsInArrears" />
		as RANDR_MIA,
		<include refid="rnrDaysInArrears" />
		as RANDR_DIA,
		NULL as RANDR_INSTALLMENT_IN_ARREARS,
		NULL as RANDR_ACCRUED_LATE_CHARGE,
		NULL as RANDR_MISC_CHARGES,
		NULL as RANDR_OUTSTANDING_BALANCE,
		NULL as RANDR_LATE_CHARGES,
		NULL as RANDR_MEMO_LATE_CHARGE,
		NULL as RANDR_OTHER_CHARGES,
		NULL as RANDR_TOTAL_DUE
		from ptraccount a
		<include refid="rnrMiaJoin" />
		where a.ID=#ACCOUNT_ID#
	</select>










</sqlMap>
	