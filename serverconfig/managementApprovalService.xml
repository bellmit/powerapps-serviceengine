<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="managementApprovalService">

<resultMap class="hmap" id="getManagementApprovalSubtypeCode">
<result property="SUBTYPE_CODE" javaType="string"/>
</resultMap>

<select id="getManagementApprovalSubtypeCode" resultMap="getManagementApprovalSubtypeCode">
select CODE from PTRTREATMENT_SUBTYPE_REF where ID=#SUBTYPE_ID#
</select>

<select id="getManagementApprovalAccountStatus" resultMap="global.ref">
<include refid="pleaseSelectRef" />
union
<include refid="refselect" /> from PTRACCOUNT_STATUS_REF
</select>

<select id="getManagementApprovalCentre" resultMap="global.ref">
<include refid="pleaseSelectRef" />
</select>

<resultMap class="hmap" id="getManagementApprovalActionType" extends="global.ref">
<result property="SUBTYPE_ID" javaType="long"/>
</resultMap>

<select id="getManagementApprovalActionType" resultMap="getManagementApprovalActionType">
<include refid="pleaseSelectRef" />, NULL
union
<include refid="refselect" />, SUBTYPE_ID from PTRMANAGEMENT_APPROVAL_ACTION_TYPE_REF
</select>

<resultMap class="hmap" id="getManagementApprovalLegalProcess" extends="global.ref">
<result property="LEGAL_PROCESS" javaType="string"/>
</resultMap>

<select id="getManagementApprovalLegalProcess" resultMap="getManagementApprovalLegalProcess">
<include refid="refselect"/>, DESCRIPTION from PTRMANAGEMENT_APPROVAL_LEGAL_PROCESS_REF
</select>

<resultMap class="hmap" id="getManagementApprovalOptionType">
		<result property="ID"  javaType="long" />
		<result property="OPTION_TYPE" javaType="string" />
		<result property="AMOUNT" javaType="$"/>
	</resultMap>
	
		<select id="getManagementApprovalOptionType" resultMap="getManagementApprovalOptionType">
select a.ID, a.DESCRIPTION, a.AMOUNT from PTRACCOUNT acc,
(values
(1,'Principal',0),
(2,'Interest',0),
(3,'Late Charges',0)
)as a(ID,DESCRIPTION,AMOUNT)
where acc.ID=#ACCOUNT_ID#
	</select>

	<insert id="insertTreatmentManagementApproval" parameterClass="map">
		insert into PTRTREATMENT_MANAGEMENT_APPROVAL
		(ACTION_TYPE_ID,CENTRE_ID,ACCOUNT_STATUS_ID,EARLY_SETTLEMENT_FIGURE,EARLY_SETTLEMENT_FIGURE_DATE, 
		SYSTEM_REBATE,BORROWER_TRACEABLE,BORROWER_NEW_ADDRESS,BORROWER_LATEST_CONTACT,BORROWER_REMARKS,
		GUARANTOR_TRACEABLE,GUARANTOR_NEW_ADDRESS,GUARANTOR_LATEST_CONTACT,GUARANTOR_REMARKS,DESCRIPTION_RECOMMENDATION, 
		COMMENTS,TEAM_LEADER_MANAGER_REMARKS,HQ_REMARKS,DATE_OF_APPROVAL,REASON_CAME_FOR, 
		APPROVAL_CONDITION,APPROVAL_REQUESTED,LPI_WAIVED,TEMPLATE_VERSION_ID,MANAGER_NAME_1,
		MANAGER_POSITION_1,MANAGER_DEPARTMENT_1,MANAGER_NAME_2,MANAGER_POSITION_2,MANAGER_DEPARTMENT_2,
		DEPUTY_VP_NAME,DEPUTY_VP_POSITION,DEPUTY_VP_DEPARTMENT,HOD_NAME,HOD_POSITION,
		HOD_DEPARTMENT,MANAGER_APPROVAL_DATE,MANAGER_APPROVAL_CONDITION,HOC_APPROVAL_DATE,HOC_APPROVAL_CONDITION,
		HOD_APPROVAL_DATE,HOD_APPROVAL_CONDITION,BLANKET_LEGAL_REMARKS,BLANKET_WAIVER_REMARKS,TREATMENT_ID, 
		TYPE_STATUS_ID,SUBTYPE_ID,ACCOUNT_ID)
		values
		(#ACTION_TYPE_ID#,#CENTRE_ID#,#STATUS_OF_ACCOUNT#,#EARLY_SETTLEMENT_FIGURE#,#EARLY_SETTLEMENT_FIGURE_DATE#, 
		#SYSTEM_REBATE#,#BORROWER_TRACEABLE#,#BORROWER_NEW_ADDRESS#,#BORROWER_LATEST_CONTACT#,#BORROWER_REMARKS#, 
		#GUARANTOR_TRACEABLE#,#GUARANTOR_NEW_ADDRESS#,#GUARANTOR_LATEST_CONTACT#,#GUARANTOR_REMARKS#,#DESCRIPTION_RECOMMENDATION#, 
		#COMMENTS#,#TEAM_LEADER_MANAGER_REMARKS#,#HQ_REMARKS#,#DATE_OF_APPROVAL#,#REASON_CAME_FOR#, 
		#APPROVAL_CONDITION#,#APPROVAL_REQUESTED#,#LPI_WAIVED#,#TEMPLATE_VERSION_ID#,#MANAGER_NAME_1#,
		#MANAGER_POSITION_1#,#MANAGER_DEPARTMENT_1#,#MANAGER_NAME_2#,#MANAGER_POSITION_2#,#MANAGER_DEPARTMENT_2#,
		#DEPUTY_VP_NAME#,#DEPUTY_VP_POSITION#,#DEPUTY_VP_DEPARTMENT#,#HOD_NAME#,#HOD_POSITION#,
		#HOD_DEPARTMENT#,#MANAGER_APPROVAL_DATE#,#MANAGER_APPROVAL_CONDITION#,#HOC_APPROVAL_DATE#,#HOC_APPROVAL_CONDITION#,
		#HOD_APPROVAL_DATE#,#HOD_APPROVAL_CONDITION#,#BLANKET_LEGAL_REMARKS#,#BLANKET_WAIVER_REMARKS#,#ID#, 
		#TYPE_STATUS_ID#,#SUBTYPE_ID#,#ACCOUNT_ID#)
	</insert>

	<update id="updateTreatmentManagementApproval" parameterClass="map">
		update
		PTRTREATMENT_MANAGEMENT_APPROVAL set
		ACTION_TYPE_ID = #ACTION_TYPE_ID#,
		CENTRE_ID = #CENTRE_ID#,
		ACCOUNT_STATUS_ID = #STATUS_OF_ACCOUNT#,
		EARLY_SETTLEMENT_FIGURE = #EARLY_SETTLEMENT_FIGURE#,
		EARLY_SETTLEMENT_FIGURE_DATE = #EARLY_SETTLEMENT_FIGURE_DATE#,
		
		SYSTEM_REBATE = #SYSTEM_REBATE#,
		BORROWER_TRACEABLE= #BORROWER_TRACEABLE#,
		BORROWER_NEW_ADDRESS = #BORROWER_NEW_ADDRESS#,
		BORROWER_LATEST_CONTACT = #BORROWER_LATEST_CONTACT#,
		BORROWER_REMARKS = #BORROWER_REMARKS#,
		
		GUARANTOR_TRACEABLE = #GUARANTOR_TRACEABLE#,
		GUARANTOR_NEW_ADDRESS =#GUARANTOR_NEW_ADDRESS#,
		GUARANTOR_LATEST_CONTACT = #GUARANTOR_LATEST_CONTACT#,
		GUARANTOR_REMARKS = #GUARANTOR_REMARKS#,
		DESCRIPTION_RECOMMENDATION = #DESCRIPTION_RECOMMENDATION#,
		
		COMMENTS = #COMMENTS#,
		TEAM_LEADER_MANAGER_REMARKS = #TEAM_LEADER_MANAGER_REMARKS#,
		HQ_REMARKS = #HQ_REMARKS#,
		DATE_OF_APPROVAL = #DATE_OF_APPROVAL#,
		REASON_CAME_FOR = #REASON_CAME_FOR#,
		
		APPROVAL_CONDITION = #APPROVAL_CONDITION#,
		APPROVAL_REQUESTED = #APPROVAL_REQUESTED#,
		LPI_WAIVED = #LPI_WAIVED#,
		TEMPLATE_VERSION_ID=#TEMPLATE_VERSION_ID#,
		TYPE_STATUS_ID=#TYPE_STATUS_ID#,
		
		SUBTYPE_ID=#SUBTYPE_ID#,
		MANAGER_NAME_1=#MANAGER_NAME_1#,
		MANAGER_POSITION_1=#MANAGER_POSITION_1#,
		MANAGER_DEPARTMENT_1=#MANAGER_DEPARTMENT_1#,
		MANAGER_NAME_2=#MANAGER_NAME_2#,
		
		MANAGER_POSITION_2=#MANAGER_POSITION_2#,          
		MANAGER_DEPARTMENT_2=#MANAGER_DEPARTMENT_2#,
		DEPUTY_VP_NAME=#DEPUTY_VP_NAME#,
		DEPUTY_VP_POSITION=#DEPUTY_VP_POSITION#,
		DEPUTY_VP_DEPARTMENT=#DEPUTY_VP_DEPARTMENT#,
		
		HOD_NAME=#HOD_NAME#,                  
		HOD_POSITION=#HOD_POSITION#,
		HOD_DEPARTMENT=#HOD_DEPARTMENT#,
		MANAGER_APPROVAL_DATE=#MANAGER_APPROVAL_DATE#,
		MANAGER_APPROVAL_CONDITION=#MANAGER_APPROVAL_CONDITION#,
		
		HOC_APPROVAL_DATE=#HOC_APPROVAL_DATE#,
		HOC_APPROVAL_CONDITION=#HOC_APPROVAL_CONDITION#,
		HOD_APPROVAL_DATE=#HOD_APPROVAL_DATE#,
		HOD_APPROVAL_CONDITION=#HOD_APPROVAL_CONDITION#,
		BLANKET_LEGAL_REMARKS=#BLANKET_LEGAL_REMARKS#,
		
		BLANKET_WAIVER_REMARKS=#BLANKET_WAIVER_REMARKS#
		where
		TREATMENT_ID = #ID#  
 	</update>
 	
 	<delete id="deleteTreatmentManagementApprovalAppendixB" parameterClass="map">
 	delete from ptrtreatment_management_approval_appendixb where treatment_id=#ID#
 	</delete>

<insert id="insertTreatmentManagementApprovalAppendixB" parameterClass="map">
<selectKey keyProperty="ID" resultClass="long">
			<include refid="sequencePrefix" />
			ptrtreatment_management_approval_appendixb_id
			<include refid="sequenceSuffix" />
		</selectKey>
insert into ptrtreatment_management_approval_appendixb 
(ID,TREATMENT_ID,OPTION_TYPE_ID,AMOUNT,BORROWERS_PROPOSAL,WAIVER_AMOUNT)
values (#ID#,#TREATMENT_ID#,#OPTION_TYPE_ID#,#AMOUNT#,#BORROWERS_PROPOSAL#,#WAIVER_AMOUNT#)
</insert>

 	<delete id="deleteTreatmentManagementApprovalAppendixD" parameterClass="map">
 	delete from ptrtreatment_management_approval_appendixd where treatment_id=#ID#
 	</delete>

<insert id="insertTreatmentManagementApprovalAppendixD" parameterClass="map">
<selectKey keyProperty="ID" resultClass="long">
			<include refid="sequencePrefix" />
			ptrtreatment_management_approval_appendixd_id
			<include refid="sequenceSuffix" />
		</selectKey>
insert into ptrtreatment_management_approval_appendixd 
(ID,TREATMENT_ID,LEGAL_PROCESS_ID,DATED,PROFESSIONAL_FEES_AMOUNT,DISBURSEMENT_FEES_AMOUNT,TOTAL_AMOUNT)
values (#ID#,#TREATMENT_ID#,#LEGAL_PROCESS_ID#,#DATED#,#PROFESSIONAL_FEES#,#DISBURSEMENT_FEES#,#TOTAL#)
</insert>





	<resultMap id="getTreatmentManagementApproval" class="hmap">
		<result property="ACTION_TYPE_ID" javaType="long" />
		<result property="CENTRE" javaType="long" />
		<result property="STATUS_OF_ACCOUNT" javaType="long" />
		<result property="EARLY_SETTLEMENT_FIGURE" javaType="long" />
		<result property="EARLY_SETTLEMENT_FIGURE_DATE" javaType="date" />
		
		<result property="SYSTEM_REBATE" javaType="java.math.BigDecimal" />
		<result property="BORROWER_TRACEABLE" javaType="long" />
		<result property="BORROWER_NEW_ADDRESS" javaType="string" />
		<result property="BORROWER_LATEST_CONTACT" javaType="string" />
		<result property="BORROWER_REMARKS" javaType="string" />
		
		<result property="GUARANTOR_TRACEABLE" javaType="long" />
		<result property="GUARANTOR_NEW_ADDRESS" javaType="string" />
		<result property="GUARANTOR_LATEST_CONTACT" javaType="string" />
		<result property="GUARANTOR_REMARKS" javaType="string" />
		<result property="DESCRIPTION_RECOMMENDATION" javaType="string" />
		
		<result property="COMMENTS" javaType="string" />
		<result property="TEAM_LEADER_MANAGER_REMARKS" javaType="string" />
		<result property="HQ_REMARKS" javaType="string" />
		<result property="DATE_OF_APPROVAL" javaType="date" />
		<result property="REASON_CAME_FOR" javaType="string" />
		
		<result property="APPROVAL_CONDITION" javaType="string" />
		<result property="APPROVAL_REQUESTED" javaType="string" />
		<result property="LPI_WAIVED" javaType="java.math.BigDecimal" />
		<result property="TEMPLATE_VERSION_ID" javaType="long"/>
		<result property="TREATMENT__ID" javaType="long" jdbcType="NUMERIC" />
		
		<result property="MANAGER_NAME_1" javaType="string" />
		<result property="MANAGER_POSITION_1" javaType="string" />
		<result property="MANAGER_DEPARTMENT_1" javaType="string" />
		<result property="MANAGER_NAME_2" javaType="string" />
		<result property="MANAGER_POSITION_2" javaType="string" />
		
		<result property="MANAGER_DEPARTMENT_2" javaType="string" />
		<result property="DEPUTY_VP_NAME" javaType="string" />
		<result property="DEPUTY_VP_POSITION" javaType="string" />
		<result property="DEPUTY_VP_DEPARTMENT" javaType="string" />
		<result property="HOD_NAME" javaType="string" />
		
		<result property="HOD_POSITION" javaType="string" />
		<result property="HOD_DEPARTMENT" javaType="string" />
		<result property="MANAGER_APPROVAL_DATE" javaType="date" />
		<result property="MANAGER_APPROVAL_CONDITION" javaType="string" />
		<result property="HOC_APPROVAL_DATE" javaType="date" />
		
		<result property="HOC_APPROVAL_CONDITION" javaType="string" />
		<result property="HOD_APPROVAL_DATE" javaType="date" />
		<result property="HOD_APPROVAL_CONDITION" javaType="string" />
		<result property="BLANKET_LEGAL_REMARKS" javaType="string"/>
		<result property="BLANKET_WAIVER_REMARKS" javaType="string"/>
		
		<result property="SUBTYPE_ID" javaType="long"/>
	</resultMap>

	<select id="getTreatmentManagementApproval" resultMap="getTreatmentManagementApproval">
		SELECT 
		ACTION_TYPE_ID,CENTRE_ID,ACCOUNT_STATUS_ID,EARLY_SETTLEMENT_FIGURE,EARLY_SETTLEMENT_FIGURE_DATE,
		SYSTEM_REBATE,BORROWER_TRACEABLE,BORROWER_NEW_ADDRESS,BORROWER_LATEST_CONTACT,BORROWER_REMARKS, 
		GUARANTOR_TRACEABLE,GUARANTOR_NEW_ADDRESS,GUARANTOR_LATEST_CONTACT, GUARANTOR_REMARKS,DESCRIPTION_RECOMMENDATION, 
		COMMENTS,TEAM_LEADER_MANAGER_REMARKS,HQ_REMARKS,DATE_OF_APPROVAL,REASON_CAME_FOR, 
		APPROVAL_CONDITION,APPROVAL_REQUESTED,LPI_WAIVED,TEMPLATE_VERSION_ID,TREATMENT_ID,
		MANAGER_NAME_1,MANAGER_POSITION_1,MANAGER_DEPARTMENT_1,MANAGER_NAME_2,MANAGER_POSITION_2,          
		MANAGER_DEPARTMENT_2,DEPUTY_VP_NAME,DEPUTY_VP_POSITION,DEPUTY_VP_DEPARTMENT,HOD_NAME,                  
		HOD_POSITION,HOD_DEPARTMENT,MANAGER_APPROVAL_DATE,MANAGER_APPROVAL_CONDITION,HOC_APPROVAL_DATE,           
		HOC_APPROVAL_CONDITION,HOD_APPROVAL_DATE,HOD_APPROVAL_CONDITION,BLANKET_LEGAL_REMARKS,BLANKET_WAIVER_REMARKS,
		SUBTYPE_ID
		FROM PTRTREATMENT_MANAGEMENT_APPROVAL
		where TREATMENT_ID=#ID#
  	</select>
  	
  	<resultMap class="hmap" id="getManagementApprovalAppendixB">
  	<result property="OPTION_TYPE_ID" javaType="long"/>
  	<result property="AMOUNT" javaType="$"/>
  	<result property="BORROWERS_PROPOSAL" javaType="$"/>
  	<result property="WAIVER_AMOUNT" javaType="$"/>
  	</resultMap>
  	
  	<select id="getManagementApprovalAppendixB" resultMap="getManagementApprovalAppendixB">
  	select OPTION_TYPE_ID,AMOUNT,BORROWERS_PROPOSAL,WAIVER_AMOUNT from PTRTREATMENT_MANAGEMENT_APPROVAL_APPENDIXB
  	where TREATMENT_ID=#ID#
  	</select>
  	
  	<resultMap class="hmap" id="getManagementApprovalAppendixD">
  	<result property="LEGAL_PROCESS_ID" javaType="long"/>
  	<result property="DATED" javaType="date"/>
  	<result property="PROFESSIONAL_FEES" javaType="$"/>
  	<result property="DISBURSEMENT_FEES" javaType="$"/>
  	<result property="TOTAL" javaType="$"/>
  	</resultMap>
  	
  	<select id="getManagementApprovalAppendixD" resultMap="getManagementApprovalAppendixD">
  	select LEGAL_PROCESS_ID,DATED,PROFESSIONAL_FEES_AMOUNT,DISBURSEMENT_FEES_AMOUNT,TOTAL_AMOUNT
  	from PTRTREATMENT_MANAGEMENT_APPROVAL_APPENDIXD
  	where TREATMENT_ID=#ID#
  	</select>
  	
  	
  	


	
	
	
	
	
	
	
	
	
	
	
	

</sqlMap>