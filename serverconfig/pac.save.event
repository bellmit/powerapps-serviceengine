<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<event transactional="false" type="event">
 <exec type="guard">
  <conditions>
   <condition lhsfield="IS_NEW_TREATMENT" operator="=" rhsvalue="true"/>
  </conditions>
  <exec statement="insertTreatmentPac" type="insert"/>
  <exec type="guard">
   <conditions>
    <condition lhsfield="showPTP" operator="=" rhsvalue="SHOW"/>
    <condition lhsfield="INSTALLMENT_AMOUNT" operator="is not empty" rhsvalue=""/>
    <condition lhsfield="PTP_DATE" operator="is not empty" rhsvalue=""/>
    <condition lhsfield="PTP_AMOUNT" operator="is not empty" rhsvalue=""/>
    <condition lhsfield="CONTACT_PERSON" operator="is not empty" rhsvalue=""/>
   </conditions>
   <exec argument="PTP_LIST" query="getTreatmentCallPtpTypeStatus" type="query"/>
   <exec from="UPDATED_TIME" key="UPDATED_TIME" to="PTP_LIST" type="copyintolist"/>
   <exec from="UPDATED_USER_ID" key="UPDATED_USER_ID" to="PTP_LIST" type="copyintolist"/>
   <exec from="ACCOUNT_ID" key="ACCOUNT_ID" to="PTP_LIST" type="copyintolist"/>
   <exec from="TRUE" key="TRUE" to="PTP_LIST" type="copyintolist"/>
   <exec from="FALSE" key="FALSE" to="PTP_LIST" type="copyintolist"/>
   <exec from="ID" key="CALL_TREATMENT_ID" to="PTP_LIST" type="copyintolist"/>
   <exec from="INSTALLMENT_AMOUNT" key="INSTALLMENT_AMOUNT" to="PTP_LIST" type="copyintolist"/>
   <exec from="PTP_DATE" key="PTP_DATE" to="PTP_LIST" type="copyintolist"/>
   <exec from="CONTACT_PERSON" key="PTP_PERSON" to="PTP_LIST" type="copyintolist"/>
   <exec from="PTP_AMOUNT" key="PTP_AMOUNT" to="PTP_LIST" type="copyintolist"/>
   <exec from="NOTE_TEXT" key="NOTE_TEXT" to="PTP_LIST" type="copyintolist"/>
   <exec argument="PTP_LIST" type="loop">
    <exec event="treatment.save" ignoreresult="true" type="raisewith"/>
    <exec recordcount="" statement="updateTreatmentCallPtp" type="update"/>
   </exec>
  </exec>
 </exec>
 <exec type="guard">
  <conditions>
   <condition lhsfield="IS_NEW_TREATMENT" operator="&lt;&gt;" rhsvalue="true"/>
  </conditions>
  <exec recordcount="" statement="updateTreatmentPac" type="update"/>
 </exec>
</event>
