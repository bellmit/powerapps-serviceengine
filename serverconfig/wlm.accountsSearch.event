<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<event transactional="false" type="event">
 <exec event="wlm.getUserType" ignoreresult="true" type="raise"/>
 <exec ceiling="false" endmonth="false" nextweekday="false" startmonth="false" truncate="true" type="date"/>
 <exec text="Get search arguments" type="comment">
  <exec message="getPagingArguments" target="PAGING_CONDITION" type="formattext"/>
  <exec count="1" to="RESULT_LIST" type="createlist"/>
 </exec>
 <exec text="Check pagination condition" type="comment">
  <exec type="guard">
   <conditions>
    <condition lhsfield="PAGING_CONDITION" operator="=" rhsvalue="getPagingArguments"/>
   </conditions>
   <exec event="wlm.searchPaging" ignoreresult="true" type="raise"/>
  </exec>
 </exec>
 <exec text="Get accounts for assignment" type="comment">
  <exec type="guard">
   <conditions>
    <condition lhsfield="TYPE_CODE" operator="=" rhsvalue="bankuser"/>
   </conditions>
   <exec argument="ACCOUNTS" query="getWlmAccountsForAssignment" type="query"/>
   <exec list="ACCOUNTS" to="COUNT_OF_ACCOUNTS" type="countlist"/>
   <exec from="ACCOUNTS" key="ACCOUNT_ID" to="ACCOUNTS" type="extract"/>
  </exec>
  <exec type="guard">
   <conditions>
    <condition lhsfield="TYPE_CODE" operator="=" rhsvalue="agencyuser"/>
   </conditions>
   <exec argument="ASSIGNMENTS" query="getWlmAccountsAgencyForAssignment" type="query"/>
   <exec list="ASSIGNMENTS" to="COUNT_OF_ASSIGNMENTS" type="countlist"/>
   <exec from="COUNT_OF_ASSIGNMENTS" to="COUNT_OF_ACCOUNTS" type="copy"/>
   <exec from="ASSIGNMENTS" key="AGENCY_ASSIGNMENT_ID" to="ASSIGNMENTS" type="extract"/>
  </exec>
 </exec>
 <exec text="Get account details" type="comment">
  <exec type="guard">
   <conditions>
    <condition lhsfield="COUNT_OF_ACCOUNTS" operator="&lt;&gt;" rhsvalue="0"/>
   </conditions>
   <exec type="guard">
    <conditions>
     <condition lhsfield="TYPE_CODE" operator="=" rhsvalue="bankuser"/>
    </conditions>
    <exec argument="SEARCH_RESULT_LIST" query="getWlmSearchResultInformation" type="query"/>
   </exec>
   <exec type="guard">
    <conditions>
     <condition lhsfield="TYPE_CODE" operator="=" rhsvalue="agencyuser"/>
    </conditions>
    <exec argument="SEARCH_RESULT_LIST" query="getWlmAgencySearchResultInformation" type="query"/>
   </exec>
   <exec list="SEARCH_RESULT_LIST" to="SEARCH_RESULT_LIST" type="unique"/>
   <exec message="getPagingProcess" target="PAGING_CONDITION" type="formattext"/>
   <exec type="guard">
    <conditions>
     <condition lhsfield="PAGING_CONDITION" operator="=" rhsvalue="getPagingProcess"/>
    </conditions>
    <exec event="wlm.searchPaging" ignoreresult="true" type="raise"/>
   </exec>
   <exec from="BOOL_TRUE" key="NO_RECORDS_FOUND" to="RESULT_LIST" type="copyintolist"/>
   <exec from="PAGE_NUMBER" key="PAGE_NUMBER" to="RESULT_LIST" type="copyintolist"/>
   <exec from="DISABLE_PREV" key="DISABLE_PREV" to="RESULT_LIST" type="copyintolist"/>
   <exec from="DISABLE_NEXT" key="DISABLE_NEXT" to="RESULT_LIST" type="copyintolist"/>
   <exec from="COUNT" key="COUNT" to="RESULT_LIST" type="copyintolist"/>
   <exec from="SEARCH_RESULT_LIST" key="SEARCH_RESULT_LIST" to="RESULT_LIST" type="copyintolist"/>
   <exec from="RESULT_LIST" type="copy"/>
  </exec>
 </exec>
</event>
