<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<event transactional="true" type="event">
 <exec count="1" type="createlist"/>
 <exec to="LOGON_USER" type="user"/>
 <exec ceiling="false" endmonth="false" nextweekday="false" startmonth="false" truncate="false" type="date"/>
 <exec key="VALID" minuend="SPREADSHEET_LIST" subtrahend="FALSE" to="SPREADSHEET_LIST" type="remove"/>
 <exec from="LOGON_USER" key="CREATED_USER_ID" to="SPREADSHEET_LIST" type="copyintolist"/>
 <exec from="CURRENT_DATE" key="CREATED_TIME" to="SPREADSHEET_LIST" type="copyintolist"/>
 <exec argument="EMPLOYER_LIST" query="getEmployerId" type="query"/>
 <exec from="EMPLOYER_LIST" key="EMPLOYER_CODE" to="SPREADSHEET_LIST" type="merge"/>
 <exec argument="SPREADSHEET_LIST" type="loop">
  <exec statement="insertRsImportTemp" type="insert"/>
  <exec statement="insertRsImportHistory" type="insert"/>
 </exec>
 <exec argument="TREATMENT_LIST" query="getRsLatestExpiryDate" type="query"/>
 <exec from="LOGON_USER" key="UPDATED_USER_ID" to="TREATMENT_LIST" type="copyintolist"/>
 <exec from="CURRENT_DATE" key="UPDATED_TIME" to="TREATMENT_LIST" type="copyintolist"/>
 <exec argument="TREATMENT_LIST" type="loop">
  <exec event="treatment.save" ignoreresult="true" type="raisewith"/>
 </exec>
 <exec statement="deleteRsImportTemp" type="delete"/>
 <exec message="Save Successful" target="MESSAGE" type="formattext"/>
 <exec from="TRUE" key="OPEN_MESSAGE" type="copyintolist"/>
 <exec from="MESSAGE" key="MESSAGE" type="copyintolist"/>
 <exec from="TRUE" key="TreatmentWorkpadRefresh" type="copyintolist"/>
</event>
