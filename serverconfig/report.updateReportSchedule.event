<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<event transactional="true" type="event">
 <exec count="1" type="createlist"/>
 <exec message="ReportManagementService" target="REQUESTING_SERVICE" type="formattext"/>
 <exec message="N/A" target="REQUESTING_HOST" type="formattext"/>
 <exec from="TRUE" key="OPEN_MESSAGE" type="copyintolist"/>
 <exec from="TRUE" key="TRUE" type="copyintolist"/>
 <exec from="FALSE" key="FALSE" type="copyintolist"/>
 <exec from="TRUE" key="CLOSE" type="copyintolist"/>
 <exec ceiling="false" endmonth="false" nextweekday="false" startmonth="false" to="REQUEST_TIME" truncate="false" type="date"/>
 <exec type="guard">
  <conditions>
   <condition lhsfield="TYPE_ID" operator="=" rhsvalue="1"/>
  </conditions>
  <exec recordcount="" statement="updateOverrideSchedule" type="update"/>
  <exec statement="insertReportEventSchedule" type="insert"/>
  <exec from="REQUEST_TIME" to="UPDATED_TIME" type="copy"/>
  <exec to="UPDATED_USER_ID" type="user"/>
  <exec from="ID" to="EVENT_SCHEDULE_ID" type="copy"/>
  <exec statement="getReportBatchIdForSchedule" type="select"/>
  <exec type="guard">
   <conditions>
    <condition lhsfield="BATCH_ID" operator="is empty" rhsvalue=""/>
   </conditions>
   <exec message="Auto batch for report {0}" target="DESCRIPTION" type="formattext">
    <key value="REPORT_ID"/>
   </exec>
   <exec to="CREATED_USER_ID" type="user"/>
   <exec from="CREATED_USER_ID" to="UPDATED_USER_ID" type="copy"/>
   <exec from="REQUEST_TIME" to="CREATED_TIME" type="copy"/>
   <exec from="REQUEST_TIME" to="UPDATED_TIME" type="copy"/>
   <exec from="REPORT_ID" to="REQUEST_ID" type="copy"/>
   <exec statement="insertReportCustomBatch" type="insert"/>
   <exec statement="addReportForCustomBatch" type="insert"/>
  </exec>
  <exec type="guard">
   <conditions>
    <condition lhsfield="SELECTED_MINUTES" operator="is not empty" rhsvalue=""/>
   </conditions>
   <exec from="EVENT_SCHEDULE_ID" key="EVENT_SCHEDULE_ID" to="SELECTED_MINUTES" type="copyintolist"/>
   <exec argument="SELECTED_MINUTES" type="loop">
    <exec statement="insertScheduleRecurringMinute" type="insert"/>
   </exec>
  </exec>
  <exec type="guard">
   <conditions>
    <condition lhsfield="SELECTED_HOURS" operator="is not empty" rhsvalue=""/>
   </conditions>
   <exec from="EVENT_SCHEDULE_ID" key="EVENT_SCHEDULE_ID" to="SELECTED_HOURS" type="copyintolist"/>
   <exec argument="SELECTED_HOURS" type="loop">
    <exec statement="insertScheduleRecurringHour" type="insert"/>
   </exec>
  </exec>
  <exec type="guard">
   <conditions>
    <condition lhsfield="SELECTED_DAYS_OF_MONTH" operator="is not empty" rhsvalue=""/>
   </conditions>
   <exec from="EVENT_SCHEDULE_ID" key="EVENT_SCHEDULE_ID" to="SELECTED_DAYS_OF_MONTH" type="copyintolist"/>
   <exec argument="SELECTED_DAYS_OF_MONTH" type="loop">
    <exec statement="insertScheduleRecurringDayOfMonth" type="insert"/>
   </exec>
  </exec>
  <exec type="guard">
   <conditions>
    <condition lhsfield="SELECTED_DAYS_OF_WEEK" operator="is not empty" rhsvalue=""/>
   </conditions>
   <exec from="EVENT_SCHEDULE_ID" key="EVENT_SCHEDULE_ID" to="SELECTED_DAYS_OF_WEEK" type="copyintolist"/>
   <exec argument="SELECTED_DAYS_OF_WEEK" type="loop">
    <exec statement="insertScheduleRecurringDayOfWeek" type="insert"/>
   </exec>
  </exec>
  <exec type="guard">
   <conditions>
    <condition lhsfield="SELECTED_MONTHS" operator="is not empty" rhsvalue=""/>
   </conditions>
   <exec from="EVENT_SCHEDULE_ID" key="EVENT_SCHEDULE_ID" to="SELECTED_MONTHS" type="copyintolist"/>
   <exec argument="SELECTED_MONTHS" type="loop">
    <exec statement="insertScheduleRecurringMonth" type="insert"/>
   </exec>
  </exec>
  <exec type="guard">
   <conditions>
    <condition lhsfield="SELECTED_YEARS" operator="is not empty" rhsvalue=""/>
   </conditions>
   <exec from="EVENT_SCHEDULE_ID" key="EVENT_SCHEDULE_ID" to="SELECTED_YEARS" type="copyintolist"/>
   <exec argument="SELECTED_YEARS" type="loop">
    <exec statement="insertScheduleRecurringYear" type="insert"/>
   </exec>
  </exec>
  <exec type="guard">
   <conditions>
    <condition lhsfield="PROJECTED" operator="is not empty" rhsvalue=""/>
   </conditions>
   <exec statement="deleteUnusedReportGenerationProjection" type="delete"/>
   <exec from="REPORT_ID" key="REPORT_ID" to="PROJECTED" type="copyintolist"/>
   <exec argument="PROJECTED" type="loop">
    <exec statement="insertReportGenerationProjection" type="insert"/>
   </exec>
  </exec>
  <exec message="Schedule have been updated" target="MESSAGE" type="formattext"/>
 </exec>
 <exec type="guard">
  <conditions>
   <condition lhsfield="TYPE_ID" operator="=" rhsvalue="2"/>
  </conditions>
  <exec statement="scheduleOnceData" type="select"/>
  <exec message="{0} {1} {2} {3} {4} {5}" target="SCHEDULE_CRON" type="formattext">
   <key value="MINUTES"/>
   <key value="HOUR"/>
   <key value="DAY_OF_MONTH"/>
   <key value="DAY_OF_WEEK"/>
   <key value="MONTH"/>
   <key value="YEAR"/>
  </exec>
  <exec recordcount="" statement="updateOverrideSchedule" type="update"/>
  <exec statement="insertReportEventSchedule" type="insert"/>
  <exec from="REQUEST_TIME" to="UPDATED_TIME" type="copy"/>
  <exec to="UPDATED_USER_ID" type="user"/>
  <exec statement="getReportBatchIdForSchedule" type="select"/>
  <exec type="guard">
   <conditions>
    <condition lhsfield="BATCH_ID" operator="is empty" rhsvalue=""/>
   </conditions>
   <exec message="Auto batch for report {0}" target="DESCRIPTION" type="formattext">
    <key value="REPORT_NAME"/>
   </exec>
   <exec to="CREATED_USER_ID" type="user"/>
   <exec from="CREATED_USER_ID" to="UPDATED_USER_ID" type="copy"/>
   <exec from="REQUEST_TIME" to="CREATED_TIME" type="copy"/>
   <exec from="REQUEST_TIME" to="UPDATED_TIME" type="copy"/>
   <exec from="REPORT_ID" to="REQUEST_ID" type="copy"/>
   <exec statement="insertReportCustomBatch" type="insert"/>
   <exec statement="addReportForCustomBatch" type="insert"/>
  </exec>
  <exec message="Schedule have been updated" target="MESSAGE" type="formattext"/>
 </exec>
 <exec from="MESSAGE" key="MESSAGE" type="copyintolist"/>
</event>
