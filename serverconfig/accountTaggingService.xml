<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="accountTaggingService">

	<insert id="insertAkpkTaggingData">
		insert into ptrtreatment_account_tagging (treatment_id, akpk_flag, bld)
		values(#ID#, #AKPK:BOOLEAN#, #BLD:BOOLEAN#)	
	</insert>
	<update id="updateAkpkTaggingData">
		update ptrtreatment_account_tagging set akpk_flag=#AKPK#, bld=#BLD#
		where treatment_id=#ID#
	</update>
	
	<insert id="insertAkpkApprovedTaggingData">
		insert into PTRACCOUNT_TREATMENT_TAGGING (account_id, akpk_flag, bld)
		values(#ACCOUNT_ID#, #AKPK#, #BLD#)	
	</insert>
	<update id="updateAkpkApprovedTaggingData">
		update PTRACCOUNT_TREATMENT_TAGGING set akpk_flag=#AKPK#, bld=#BLD#
		where account_id=#ACCOUNT_ID#
	</update>	
	
	
	<insert id="insertBillingTaggingData">
		insert into ptrtreatment_account_tagging (treatment_id, refund_oa_deposit,refund_court_deposit)
		values(#ID#, #REFUND_OA_DEPOSIT:BOOLEAN#,#REFUND_COURT_DEPOSIT:BOOLEAN#)	
	</insert>
	<update id="updateBillingTaggingData">
		update ptrtreatment_account_tagging set refund_oa_deposit=#REFUND_OA_DEPOSIT#,refund_court_deposit=#REFUND_COURT_DEPOSIT#
		where treatment_id=#ID#
	</update>
	
	<insert id="insertBillingApprovedTaggingData">
		insert into PTRACCOUNT_TREATMENT_TAGGING (account_id, refund_oa_deposit,refund_court_deposit)
		values(#ACCOUNT_ID#, #REFUND_OA_DEPOSIT#,#REFUND_COURT_DEPOSIT#)	
	</insert>
	<update id="updateBillingApprovedTaggingData">
		update PTRACCOUNT_TREATMENT_TAGGING set refund_oa_deposit=#REFUND_OA_DEPOSIT#,refund_court_deposit=#REFUND_COURT_DEPOSIT#
		where account_id=#ACCOUNT_ID#
	</update>
	
	
	<insert id="insertDebtSalesTaggingData">
		insert into ptrtreatment_account_tagging (treatment_id, debt_sales)
		values(#ID#,#DEBT_SALES:BOOLEAN#)	
	</insert>
	<update id="updateDebtSalesTaggingData">
		update ptrtreatment_account_tagging set debt_sales=#DEBT_SALES#
		where treatment_id=#ID#
	</update>
	
	<insert id="insertDebtSalesApprovedTaggingData">
		insert into PTRACCOUNT_TREATMENT_TAGGING (account_id, debt_sales)
		values(#ACCOUNT_ID#, #DEBT_SALES#)	
	</insert>
	<update id="updateDebtSalesApprovedTaggingData">
		update PTRACCOUNT_TREATMENT_TAGGING set debt_sales=#DEBT_SALES#
		where account_id=#ACCOUNT_ID#
	</update>
	
	
	<insert id="insertEcuTaggingData">
		insert into ptrtreatment_account_tagging (treatment_id, new_disbursement)
		values(#ID#, #NEW_DISBURSEMENT:BOOLEAN#)	
	</insert>
	<update id="updateEcuTaggingData">
		update ptrtreatment_account_tagging set new_disbursement=#NEW_DISBURSEMENT#
		where treatment_id=#ID#
	</update>
	
	<insert id="insertEcuApprovedTaggingData">
		insert into PTRACCOUNT_TREATMENT_TAGGING (account_id, new_disbursement)
		values(#ACCOUNT_ID#, #NEW_DISBURSEMENT#)	
	</insert>
	<update id="updateEcuApprovedTaggingData">
		update PTRACCOUNT_TREATMENT_TAGGING set new_disbursement=#NEW_DISBURSEMENT#
		where account_id=#ACCOUNT_ID#
	</update>
	
	
	<insert id="insertLitigationTaggingData">
		insert into ptrtreatment_account_tagging (treatment_id, bankrupt, shortfall, pending_bpp, auction, auction_received_deposit, auction_received_balance)
		values(#ID#, #BANKRUPT:BOOLEAN#, #SHORTFALL:BOOLEAN#, #PENDING_BPP:BOOLEAN#, #AUCTION:BOOLEAN#, #AUCTION_RECEIVED_DEPOSIT:BOOLEAN#, #AUCTION_RECEIVED_BALANCE:BOOLEAN#)	
	</insert>
	<update id="updateLitigationTaggingData">
		update ptrtreatment_account_tagging set bankrupt=#BANKRUPT#, shortfall=#SHORTFALL#, pending_bpp=#PENDING_BPP#, auction=#AUCTION#, auction_received_deposit=#AUCTION_RECEIVED_DEPOSIT#, auction_received_balance=#AUCTION_RECEIVED_BALANCE#
		where treatment_id=#ID#
	</update>
	
	<insert id="insertLitigationApprovedTaggingData">
		insert into PTRACCOUNT_TREATMENT_TAGGING (account_id,bankrupt, shortfall, pending_bpp, auction, auction_received_deposit, auction_received_balance)
		values(#ACCOUNT_ID#, #BANKRUPT:BOOLEAN#, #SHORTFALL:BOOLEAN#, #PENDING_BPP:BOOLEAN#, #AUCTION:BOOLEAN#, #AUCTION_RECEIVED_DEPOSIT:BOOLEAN#, #AUCTION_RECEIVED_BALANCE:BOOLEAN#)	
	</insert>
	<update id="updateLitigationApprovedTaggingData">
		update PTRACCOUNT_TREATMENT_TAGGING set bankrupt=#BANKRUPT#, shortfall=#SHORTFALL#, pending_bpp=#PENDING_BPP#, auction=#AUCTION#, auction_received_deposit=#AUCTION_RECEIVED_DEPOSIT#, auction_received_balance=#AUCTION_RECEIVED_BALANCE#
		where account_id=#ACCOUNT_ID#
	</update>
	
	
	<insert id="insertMisTaggingData">
		insert into ptrtreatment_account_tagging (treatment_id, ex_staff, dibs, under_construction)
		values(#ID#, #EX_STAFF:BOOLEAN#, #DIBS:BOOLEAN#, #UNDER_CONSTRUCTION:BOOLEAN#)	
	</insert>
	<update id="updateMisTaggingData">
		update ptrtreatment_account_tagging set ex_staff=#EX_STAFF#, dibs=#DIBS#, under_construction=#UNDER_CONSTRUCTION#
		where treatment_id=#ID#
	</update>
	
	<insert id="insertMisApprovedTaggingData">
		insert into PTRACCOUNT_TREATMENT_TAGGING (account_id,ex_staff, dibs, under_construction)
		values(#ACCOUNT_ID#, #EX_STAFF:BOOLEAN#, #DIBS:BOOLEAN#, #UNDER_CONSTRUCTION:BOOLEAN#)	
	</insert>
	<update id="updateMisApprovedTaggingData">
		update PTRACCOUNT_TREATMENT_TAGGING set ex_staff=#EX_STAFF#, dibs=#DIBS#, under_construction=#UNDER_CONSTRUCTION#
		where account_id=#ACCOUNT_ID#
	</update>
	
	
	<insert id="insertProductOwnerTaggingData">
		insert into ptrtreatment_account_tagging (treatment_id, external_collection_agencies, rnr, write_off, fraud, 
		settlement_proposal, security_deposit, eca_monitoring, legal_monitoring, admin_monitoring, moratorium, redemption_statement,
		repo, repo_redeem, deceased, tpd, tpd_rejected, abandoned, epf_withdrawal,INVALID_CONTACT)
		values(#ID#, #EXTERNAL_COLLECTION_AGENCIES:BOOLEAN#, #RNR:BOOLEAN#, #WRITE_OFF:BOOLEAN#, #FRAUD:BOOLEAN#, #SETTLEMENT_PROPOSAL:BOOLEAN#,
		#SECURITY_DEPOSIT:BOOLEAN#, #ECA_MONITORING:BOOLEAN#, #LEGAL_MONITORING:BOOLEAN#, #ADMIN_MONITORING:BOOLEAN#, #MORATORIUM:BOOLEAN#,
		#REDEMPTION_STATEMENT:BOOLEAN#, #REPO:BOOLEAN#, #REPO_REDEEM:BOOLEAN#, #DECEASED:BOOLEAN#, #TPD:BOOLEAN#, #TPD_REJECTED:BOOLEAN#,
		#ABANDONED:BOOLEAN#, #EPF_WITHDRAWAL:BOOLEAN#,#INVALID_CONTACT:BOOLEAN#)	
	</insert>
	<update id="updateProductOwnerTaggingData">
		update ptrtreatment_account_tagging set external_collection_agencies=#EXTERNAL_COLLECTION_AGENCIES#, rnr=#RNR#, write_off=#WRITE_OFF#, fraud=#FRAUD#, settlement_proposal=#SETTLEMENT_PROPOSAL#,
		security_deposit=#SECURITY_DEPOSIT#, eca_monitoring=#ECA_MONITORING#, legal_monitoring=#LEGAL_MONITORING#, admin_monitoring=#ADMIN_MONITORING#, moratorium=#MORATORIUM#,
		redemption_statement=#REDEMPTION_STATEMENT#, repo=#REPO#, repo_redeem=#REPO_REDEEM#, deceased=#DECEASED#, tpd=#TPD#, tpd_rejected=#TPD_REJECTED#,
		abandoned=#ABANDONED#, epf_withdrawal=#EPF_WITHDRAWAL#, INVALID_CONTACT = #INVALID_CONTACT#
		where treatment_id=#ID#
	</update>
	
	<insert id="insertProductOwnerApprovedTaggingData">
		insert into PTRACCOUNT_TREATMENT_TAGGING (account_id, external_collection_agencies, rnr, write_off, fraud, 
		settlement_proposal, security_deposit, eca_monitoring, legal_monitoring, admin_monitoring, moratorium, redemption_statement,
		repo, repo_redeem, deceased, tpd, tpd_rejected, abandoned, epf_withdrawal,INVALID_CONTACT)
		values(#ACCOUNT_ID#, #EXTERNAL_COLLECTION_AGENCIES:BOOLEAN#, #RNR:BOOLEAN#, #WRITE_OFF:BOOLEAN#, #FRAUD:BOOLEAN#, #SETTLEMENT_PROPOSAL:BOOLEAN#,
		#SECURITY_DEPOSIT:BOOLEAN#, #ECA_MONITORING:BOOLEAN#, #LEGAL_MONITORING:BOOLEAN#, #ADMIN_MONITORING:BOOLEAN#, #MORATORIUM:BOOLEAN#,
		#REDEMPTION_STATEMENT:BOOLEAN#, #REPO:BOOLEAN#, #REPO_REDEEM:BOOLEAN#, #DECEASED:BOOLEAN#, #TPD:BOOLEAN#, #TPD_REJECTED:BOOLEAN#,
		#ABANDONED:BOOLEAN#, #EPF_WITHDRAWAL:BOOLEAN#,#INVALID_CONTACT:BOOLEAN#)	
	</insert>
	<update id="updateProductOwnerApprovedTaggingData">
		update PTRACCOUNT_TREATMENT_TAGGING set external_collection_agencies=#EXTERNAL_COLLECTION_AGENCIES#, rnr=#RNR#, write_off=#WRITE_OFF#, fraud=#FRAUD#, settlement_proposal=#SETTLEMENT_PROPOSAL#,
		security_deposit=#SECURITY_DEPOSIT#, eca_monitoring=#ECA_MONITORING#, legal_monitoring=#LEGAL_MONITORING#, admin_monitoring=#ADMIN_MONITORING#, moratorium=#MORATORIUM#,
		redemption_statement=#REDEMPTION_STATEMENT#, repo=#REPO#, repo_redeem=#REPO_REDEEM#, deceased=#DECEASED#, tpd=#TPD#, tpd_rejected=#TPD_REJECTED#,
		abandoned=#ABANDONED#, epf_withdrawal=#EPF_WITHDRAWAL#, INVALID_CONTACT =#INVALID_CONTACT#
		where account_id=#ACCOUNT_ID#
	</update>
	
	
	<insert id="insertTakafulTaggingData">
		insert into ptrtreatment_account_tagging (treatment_id,deceased,tpd,tpd_rejected)
		values(#ID#,#DECEASED:BOOLEAN#,#TPD:BOOLEAN#,#TPD_REJECTED:BOOLEAN#)	
	</insert>
	<update id="updateTakafulTaggingData">
		update ptrtreatment_account_tagging set deceased=#DECEASED#, tpd=#TPD#,tpd_rejected=#TPD_REJECTED#
		where treatment_id=#ID#
	</update>
	
	<insert id="insertTakafulApprovedTaggingData">
		insert into PTRACCOUNT_TREATMENT_TAGGING (account_id,deceased,tpd,tpd_rejected)
		values(#ACCOUNT_ID#,#DECEASED#,#TPD#,#TPD_REJECTED#)
	</insert>
	<update id="updateTakafulApprovedTaggingData">
		update PTRACCOUNT_TREATMENT_TAGGING set deceased=#DECEASED#,tpd=#TPD#,tpd_rejected=#TPD_REJECTED#
		where account_id=#ACCOUNT_ID#
	</update>
	
	<resultMap class="hmap" id="getLatestAccountTaggingDataForTreatment">
		<result property="AKPK" javaType="boolean"/>
		<result property="BLD" javaType="boolean"/>
		<result property="REFUND_OA_DEPOSIT" javaType="boolean"/>
		<result property="DEBT_SALES" javaType="boolean"/>
		<result property="NEW_DISBURSEMENT" javaType="boolean"/>
		<result property="BANKRUPT" javaType="boolean"/>
		<result property="SHORTFALL" javaType="boolean"/>
		<result property="PENDING_BPP" javaType="boolean"/>
		<result property="AUCTION" javaType="boolean"/>
		<result property="AUCTION_RECEIVED_DEPOSIT" javaType="boolean"/>
		<result property="AUCTION_RECEIVED_BALANCE" javaType="boolean"/>
		<result property="EX_STAFF" javaType="boolean"/>
		<result property="DIBS" javaType="boolean"/>
		<result property="UNDER_CONSTRUCTION" javaType="boolean"/>
		<result property="EXTERNAL_COLLECTION_AGENCIES" javaType="boolean"/>
		<result property="RNR" javaType="boolean"/>
		<result property="WRITE_OFF" javaType="boolean"/>
		<result property="FRAUD" javaType="boolean"/>
		<result property="SETTLEMENT_PROPOSAL" javaType="boolean"/>
		<result property="SECURITY_DEPOSIT" javaType="boolean"/>
		<result property="ECA_MONITORING" javaType="boolean"/>
		<result property="LEGAL_MONITORING" javaType="boolean"/>
		<result property="ADMIN_MONITORING" javaType="boolean"/>
		<result property="MORATORIUM" javaType="boolean"/>
		<result property="REDEMPTION_STATEMENT" javaType="boolean"/>
		<result property="REPO" javaType="boolean"/>
		<result property="REPO_REDEEM" javaType="boolean"/>
		<result property="DECEASED" javaType="boolean"/>
		<result property="TPD" javaType="boolean"/>
		<result property="TPD_REJECTED" javaType="boolean"/>
		<result property="ABANDONED" javaType="boolean"/>
		<result property="EPF_WITHDRAWAL" javaType="boolean"/>
		<result property="REFUND_COURT_DEPOSIT" javaType="boolean"/>
		<result property="INVALID_CONTACT" javaType="boolean"/>
	</resultMap>
	
	<select id="getLatestAccountTaggingDataForTreatment" resultMap="getLatestAccountTaggingDataForTreatment">
		select akpk_flag,bld,refund_oa_deposit,debt_sales,new_disbursement,bankrupt,shortfall,pending_bpp,auction,auction_received_deposit,
		auction_received_balance,ex_staff,dibs,under_construction,external_collection_agencies,rnr,write_off,fraud,settlement_proposal,security_deposit,
		eca_monitoring,legal_monitoring,admin_monitoring,moratorium,redemption_statement,repo,repo_redeem,deceased,tpd,tpd_rejected,abandoned,
		epf_withdrawal,refund_court_deposit,INVALID_CONTACT
		from ptraccount_treatment_tagging
		where account_id = #ACCOUNT_ID#
	</select>
	
	<resultMap class="hmap" id="getTreatmentAccountTaggingApprovalCode">
		<result property="APPROVAL_CODE" javaType="string"/>
	</resultMap>
	
	<select id="getTreatmentAccountTaggingApprovalCode" resultMap="getTreatmentAccountTaggingApprovalCode">
		select s.code as APPROVAL_CODE
		from ptrtreatment_account_tagging t
		inner join ptrtreatment tp on tp.id=t.treatment_id
		INNER JOIN ptrtreatment_subtype_ref s on s.id=tp.subtype_id
		where t.treatment_id=#ID#
	</select>

	<resultMap class="hmap" id="getTreatmentAkpkInfo">
		<result property="AKPK" javaType="boolean"/>
		<result property="BLD" javaType="boolean"/>
	</resultMap>
	
	<select id="getTreatmentAkpkInfo" resultMap="getTreatmentAkpkInfo">
		select akpk_flag, bld
		from ptrtreatment_account_tagging
		where treatment_id=#ID#
	</select>
	
	<resultMap class="hmap" id="getTreatmentBillingInfo">
		<result property="REFUND_OA_DEPOSIT" javaType="boolean"/>
		<result property="REFUND_COURT_DEPOSIT" javaType="boolean"/>
	</resultMap>
	
	<select id="getTreatmentBillingInfo" resultMap="getTreatmentBillingInfo">
		select refund_oa_deposit, refund_court_deposit
		from ptrtreatment_account_tagging
		where treatment_id=#ID#
	</select>
	
	<resultMap class="hmap" id="getTreatmentDebtSaleInfo">
		<result property="DEBT_SALES" javaType="boolean"/>
	</resultMap>
	
	<select id="getTreatmentDebtSaleInfo" resultMap="getTreatmentDebtSaleInfo">
		select debt_sales
		from ptrtreatment_account_tagging
		where treatment_id=#ID#
	</select>
	
	<resultMap class="hmap" id="getTreatmentEcuInfo">
		<result property="NEW_DISBURSEMENT" javaType="boolean"/>
	</resultMap>
	
	<select id="getTreatmentEcuInfo" resultMap="getTreatmentEcuInfo">
		select new_disbursement
		from ptrtreatment_account_tagging
		where treatment_id=#ID#
	</select>
	
	<resultMap class="hmap" id="getTreatmentLitigationInfo">
		<result property="BANKRUPT" javaType="boolean"/>
		<result property="SHORTFALL" javaType="boolean"/>
		<result property="PENDING_BPP" javaType="boolean"/>
		<result property="AUCTION" javaType="boolean"/>
		<result property="AUCTION_RECEIVED_DEPOSIT" javaType="boolean"/>
		<result property="AUCTION_RECEIVED_BALANCE" javaType="boolean"/>
	</resultMap>
	
	<select id="getTreatmentLitigationInfo" resultMap="getTreatmentLitigationInfo">
		select bankrupt, shortfall, pending_bpp, auction, auction_received_balance, auction_received_deposit
		from ptrtreatment_account_tagging
		where treatment_id=#ID#
	</select>
	
	<resultMap class="hmap" id="getTreatmentMisInfo">
		<result property="EX_STAFF" javaType="boolean"/>
		<result property="DIBS" javaType="boolean"/>
		<result property="UNDER_CONSTRUCTION" javaType="boolean"/>
	</resultMap>
	
	<select id="getTreatmentMisInfo" resultMap="getTreatmentMisInfo">
		select ex_staff, dibs, under_construction
		from ptrtreatment_account_tagging
		where treatment_id=#ID#
	</select>
	
	<resultMap class="hmap" id="getTreatmentProductOwnerInfo">
		<result property="EXTERNAL_COLLECTION_AGENCIES" javaType="boolean"/>
		<result property="RNR" javaType="boolean"/>
		<result property="WRITE_OFF" javaType="boolean"/>
		<result property="DECEASED" javaType="boolean"/>
		<result property="ABANDONED" javaType="boolean"/>
		<result property="REPO_REDEEM" javaType="boolean"/>
		<result property="TPD_REJECTED" javaType="boolean"/>
		<result property="FRAUD" javaType="boolean"/>
		<result property="SETTLEMENT_PROPOSAL" javaType="boolean"/>
		<result property="SECURITY_DEPOSIT" javaType="boolean"/>
		<result property="ECA_MONITORING" javaType="boolean"/>
		<result property="LEGAL_MONITORING" javaType="boolean"/>
		<result property="ADMIN_MONITORING" javaType="boolean"/>
		<result property="MORATORIUM" javaType="boolean"/>
		<result property="REDEMPTION_STATEMENT" javaType="boolean"/>
		<result property="REPO" javaType="boolean"/>
		<result property="TPD" javaType="boolean"/>
		<result property="EPF_WITHDRAWAL" javaType="boolean"/>
		<result property="INVALID_CONTACT" javaType="boolean"/>
	</resultMap>
	
	<select id="getTreatmentProductOwnerInfo" resultMap="getTreatmentProductOwnerInfo">
		select external_collection_agencies, rnr, write_off, deceased, abandoned, repo_redeem, tpd_rejected,
		fraud, settlement_proposal, security_deposit, eca_monitoring, legal_monitoring, admin_monitoring, moratorium,
		redemption_statement, repo, tpd, epf_withdrawal,INVALID_CONTACT
		from ptrtreatment_account_tagging
		where treatment_id=#ID#
	</select>
	
	<resultMap class="hmap" id="getTreatmentTakafulInfo">
		<result property="DECEASED" javaType="boolean"/>
		<result property="TPD" javaType="boolean"/>
		<result property="TPD_REJECTED" javaType="boolean"/>
	</resultMap>
	
	<select id="getTreatmentTakafulInfo" resultMap="getTreatmentTakafulInfo">
		select deceased, tpd, tpd_rejected
		from ptrtreatment_account_tagging
		where treatment_id=#ID#
	</select>
				
	<resultMap class="hmap" id="getAccountTaggingInformation">
		<result property="ACCOUNT_ID"/>
		<result property="AKPK"/>
		<result property="BLD"/>
		<result property="REFUND_OA_DEPOSIT"/>
		<result property="DEBT_SALES"/>
		<result property="NEW_DISBURSEMENT"/>
		
		<result property="BANKRUPT"/>
		<result property="SHORTFALL"/>
		<result property="PENDING_BPP"/>
		<result property="AUCTION"/>
		<result property="AUCTION_RECEIVED_DEPOSIT"/>
		
		<result property="AUCTION_RECEIVED_BALANCE"/>
		<result property="EX_STAFF"/>
		<result property="DIBS"/>
		<result property="UNDER_CONSTRUCTION"/>
		<result property="EXTERNAL_COLLECTION_AGENCIES"/>
		
		<result property="RNR"/>
		<result property="WRITE_OFF"/>
		<result property="FRAUD"/>
		<result property="SETTLEMENT_PROPOSAL"/>
		<result property="SECURITY_DEPOSIT"/>
		
		<result property="ECA_MONITORING"/>
		<result property="LEGAL_MONITORING"/>
		<result property="ADMIN_MONITORING"/>
		<result property="MORATORIUM"/>
		<result property="REDEMPTION_STATEMENT"/>
		
		<result property="REPO"/>
		<result property="REPO_REDEEM"/>
		<result property="DECEASED"/>
		<result property="TPD"/>
		<result property="TPD_REJECTED"/>
		
		<result property="ABANDONED"/>
		<result property="EPF_WITHDRAWAL"/>		
		<result property="REFUND_COURT_DEPOSIT"/>
		<result property="INVALID_CONTACT"/>
	</resultMap>
	<select id="getAccountTaggingInformation" resultMap="getAccountTaggingInformation">
		select account_id,
		CASE WHEN akpk_flag is true then 'Yes' when akpk_flag is false then 'No' end as akpk_flag,
		CASE WHEN bld is true then 'Yes' when bld is false then 'No' end as bld,
		CASE WHEN REFUND_OA_DEPOSIT is true then 'Yes' when REFUND_OA_DEPOSIT is false then 'No' end as REFUND_OA_DEPOSIT,
		CASE WHEN DEBT_SALES is true then 'Yes' when DEBT_SALES is false then 'No' end as DEBT_SALES,
		CASE WHEN NEW_DISBURSEMENT is true then 'Yes' when NEW_DISBURSEMENT is false then 'No' end as NEW_DISBURSEMENT,		
		CASE WHEN BANKRUPT is true then 'Yes' when BANKRUPT is false then 'No' end as BANKRUPT,
		CASE WHEN SHORTFALL is true then 'Yes' when SHORTFALL is false then 'No' end as SHORTFALL,
		CASE WHEN PENDING_BPP is true then 'Yes' when PENDING_BPP is false then 'No' end as PENDING_BPP,
		CASE WHEN AUCTION is true then 'Yes' when AUCTION is false then 'No' end as AUCTION,
		CASE WHEN AUCTION_RECEIVED_DEPOSIT is true then 'Yes' when AUCTION_RECEIVED_DEPOSIT is false then 'No' end as AUCTION_RECEIVED_DEPOSIT,		
		CASE WHEN AUCTION_RECEIVED_BALANCE is true then 'Yes' when AUCTION_RECEIVED_BALANCE is false then 'No' end as AUCTION_RECEIVED_BALANCE,
		CASE WHEN EX_STAFF is true then 'Yes' when EX_STAFF is false then 'No' end as EX_STAFF,
		CASE WHEN DIBS is true then 'Yes' when DIBS is false then 'No' end as DIBS,
		CASE WHEN UNDER_CONSTRUCTION is true then 'Yes' when UNDER_CONSTRUCTION is false then 'No' end as UNDER_CONSTRUCTION,
		CASE WHEN EXTERNAL_COLLECTION_AGENCIES is true then 'Yes' when EXTERNAL_COLLECTION_AGENCIES is false then 'No' end as EXTERNAL_COLLECTION_AGENCIES,
		CASE WHEN RNR is true then 'Yes' when RNR is false then 'No' end as RNR,
		CASE WHEN WRITE_OFF is true then 'Yes' when WRITE_OFF is false then 'No' end as WRITE_OFF,
		CASE WHEN FRAUD is true then 'Yes' when FRAUD is false then 'No' end as FRAUD,
		CASE WHEN SETTLEMENT_PROPOSAL is true then 'Yes' when SETTLEMENT_PROPOSAL is false then 'No' end as SETTLEMENT_PROPOSAL,
		CASE WHEN SECURITY_DEPOSIT is true then 'Yes' when SECURITY_DEPOSIT is false then 'No' end as SECURITY_DEPOSIT,
		CASE WHEN ECA_MONITORING is true then 'Yes' when ECA_MONITORING is false then 'No' end as ECA_MONITORING,
		CASE WHEN LEGAL_MONITORING is true then 'Yes' when LEGAL_MONITORING is false then 'No' end as LEGAL_MONITORING,
		CASE WHEN ADMIN_MONITORING is true then 'Yes' when ADMIN_MONITORING is false then 'No' end as ADMIN_MONITORING,
		CASE WHEN MORATORIUM is true then 'Yes' when MORATORIUM is false then 'No' end as MORATORIUM,
		CASE WHEN REDEMPTION_STATEMENT is true then 'Yes' when REDEMPTION_STATEMENT is false then 'No' end as REDEMPTION_STATEMENT,
		CASE WHEN REPO is true then 'Yes' when REPO is false then 'No' end as REPO,
		CASE WHEN REPO_REDEEM is true then 'Yes' when REPO_REDEEM is false then 'No' end as REPO_REDEEM,
		CASE WHEN DECEASED is true then 'Yes' when DECEASED is false then 'No' end as DECEASED,
		CASE WHEN TPD is true then 'Yes' when TPD is false then 'No' end as TPD,
		CASE WHEN TPD_REJECTED is true then 'Yes' when TPD_REJECTED is false then 'No' end as TPD_REJECTED,
		CASE WHEN ABANDONED is true then 'Yes' when ABANDONED is false then 'No' end as ABANDONED,
		CASE WHEN EPF_WITHDRAWAL is true then 'Yes' when EPF_WITHDRAWAL is false then 'No' end as EPF_WITHDRAWAL,
		CASE WHEN REFUND_COURT_DEPOSIT is true then 'Yes' when REFUND_COURT_DEPOSIT is false then 'No' end as REFUND_COURT_DEPOSIT,	
		CASE WHEN INVALID_CONTACT is true then 'Yes' when INVALID_CONTACT is false then 'No' end as INVALID_CONTACT		
		from PTRACCOUNT_TREATMENT_TAGGING
		where account_id=#ACCOUNT_ID#	
	</select>
	<select id="getAccountTaggingInformationForImport" resultMap="getAccountTaggingInformation">
		select account_id,
		CASE WHEN akpk_flag is true then 'Yes' when akpk_flag is false then 'No' end as akpk_flag,
		CASE WHEN bld is true then 'Yes' when bld is false then 'No' end as bld,
		CASE WHEN REFUND_OA_DEPOSIT is true then 'Yes' when REFUND_OA_DEPOSIT is false then 'No' end as REFUND_OA_DEPOSIT,
		CASE WHEN DEBT_SALES is true then 'Yes' when DEBT_SALES is false then 'No' end as DEBT_SALES,
		CASE WHEN NEW_DISBURSEMENT is true then 'Yes' when NEW_DISBURSEMENT is false then 'No' end as NEW_DISBURSEMENT,		
		CASE WHEN BANKRUPT is true then 'Yes' when BANKRUPT is false then 'No' end as BANKRUPT,
		CASE WHEN SHORTFALL is true then 'Yes' when SHORTFALL is false then 'No' end as SHORTFALL,
		CASE WHEN PENDING_BPP is true then 'Yes' when PENDING_BPP is false then 'No' end as PENDING_BPP,
		CASE WHEN AUCTION is true then 'Yes' when AUCTION is false then 'No' end as AUCTION,
		CASE WHEN AUCTION_RECEIVED_DEPOSIT is true then 'Yes' when AUCTION_RECEIVED_DEPOSIT is false then 'No' end as AUCTION_RECEIVED_DEPOSIT,		
		CASE WHEN AUCTION_RECEIVED_BALANCE is true then 'Yes' when AUCTION_RECEIVED_BALANCE is false then 'No' end as AUCTION_RECEIVED_BALANCE,
		CASE WHEN EX_STAFF is true then 'Yes' when EX_STAFF is false then 'No' end as EX_STAFF,
		CASE WHEN DIBS is true then 'Yes' when DIBS is false then 'No' end as DIBS,
		CASE WHEN UNDER_CONSTRUCTION is true then 'Yes' when UNDER_CONSTRUCTION is false then 'No' end as UNDER_CONSTRUCTION,
		CASE WHEN EXTERNAL_COLLECTION_AGENCIES is true then 'Yes' when EXTERNAL_COLLECTION_AGENCIES is false then 'No' end as EXTERNAL_COLLECTION_AGENCIES,
		CASE WHEN RNR is true then 'Yes' when RNR is false then 'No' end as RNR,
		CASE WHEN WRITE_OFF is true then 'Yes' when WRITE_OFF is false then 'No' end as WRITE_OFF,
		CASE WHEN FRAUD is true then 'Yes' when FRAUD is false then 'No' end as FRAUD,
		CASE WHEN SETTLEMENT_PROPOSAL is true then 'Yes' when SETTLEMENT_PROPOSAL is false then 'No' end as SETTLEMENT_PROPOSAL,
		CASE WHEN SECURITY_DEPOSIT is true then 'Yes' when SECURITY_DEPOSIT is false then 'No' end as SECURITY_DEPOSIT,
		CASE WHEN ECA_MONITORING is true then 'Yes' when ECA_MONITORING is false then 'No' end as ECA_MONITORING,
		CASE WHEN LEGAL_MONITORING is true then 'Yes' when LEGAL_MONITORING is false then 'No' end as LEGAL_MONITORING,
		CASE WHEN ADMIN_MONITORING is true then 'Yes' when ADMIN_MONITORING is false then 'No' end as ADMIN_MONITORING,
		CASE WHEN MORATORIUM is true then 'Yes' when MORATORIUM is false then 'No' end as MORATORIUM,
		CASE WHEN REDEMPTION_STATEMENT is true then 'Yes' when REDEMPTION_STATEMENT is false then 'No' end as REDEMPTION_STATEMENT,
		CASE WHEN REPO is true then 'Yes' when REPO is false then 'No' end as REPO,
		CASE WHEN REPO_REDEEM is true then 'Yes' when REPO_REDEEM is false then 'No' end as REPO_REDEEM,
		CASE WHEN DECEASED is true then 'Yes' when DECEASED is false then 'No' end as DECEASED,
		CASE WHEN TPD is true then 'Yes' when TPD is false then 'No' end as TPD,
		CASE WHEN TPD_REJECTED is true then 'Yes' when TPD_REJECTED is false then 'No' end as TPD_REJECTED,
		CASE WHEN ABANDONED is true then 'Yes' when ABANDONED is false then 'No' end as ABANDONED,
		CASE WHEN EPF_WITHDRAWAL is true then 'Yes' when EPF_WITHDRAWAL is false then 'No' end as EPF_WITHDRAWAL,
		CASE WHEN REFUND_COURT_DEPOSIT is true then 'Yes' when REFUND_COURT_DEPOSIT is false then 'No' end as REFUND_COURT_DEPOSIT,	
		CASE WHEN INVALID_CONTACT is true then 'Yes' when INVALID_CONTACT is false then 'No' end as INVALID_CONTACT		
		from PTRACCOUNT_TREATMENT_TAGGING
		where account_id in (<iterate property="ACCOUNT_IDS" conjunction=",">#ACCOUNT_IDS[]#</iterate>)
	</select>	
	<resultMap class="hmap" id="getMiscAccountTaggingUploadedData">
		<result property="ACCOUNT_ID" javaType="long"/>
		<result property="ACCOUNT_NUMBER" javaType="string"/>
		<result property="CUSTOMER_NO" javaType="string"/>
		<result property="CUSTOMER_NAME" javaType="string"/>
		<result property="VALID" javaType="boolean"/>
		<result property="COLOR" javaType="string"/>
	</resultMap>
	
	<select id="getMiscAccountTaggingUploadedData" resultMap="getMiscAccountTaggingUploadedData">
		select a.id,a.account_no ,c.customer_no,c.customer_name,
		case when s.id is null then <include refid="true"/> end as VALID,
		case when s.id is not null then 'F39C12' end as COLOR
		from ptraccount a 
		inner join ptrcustomer c on c.id=a.customer_id
		left join ptrtreatment tp on tp.account_id=a.id and tp.type_id=56 and tp.status_id=15007
		left join ptrtreatment_account_tagging t on  tp.id=t.treatment_id
		left join ptrtreatment_subtype_ref s on s.id=tp.subtype_id and s.code=#APPROVAL_CODE#
		where a.account_no in (<iterate property="ACCOUNTS" conjunction=",">#ACCOUNTS[]#</iterate>)
	</select>
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	<resultMap class="hmap" id="getMiscAccountTaggingTreatment">
		<result property="ACCOUNT_ID" javaType="long"/>
		<result property="TREATMENT_ID" javaType="long"/>
	</resultMap>
	
	<select id="getMiscAccountTaggingTreatment" resultMap="getMiscAccountTaggingTreatment">
		select a.id,t.id from ptraccount a 
		inner join ptrtreatment t on t.account_id=a.id
		inner join ptrtreatment_account_tagging ta on ta.treatment_id=t.id
		where t.subtype_id=#SUBTYPE_ID# and t.status_id=15007   
	</select>
	
	<resultMap class="hmap" id="getMiscAccountTaggingData">
	<result property="ID" javaType="long"/>
		<result property="ACCOUNT_ID" javaType="long"/>
		<result property="CUSTOMER_NO" javaType="string"/>
		<result property="CUSTOMER_NAME" javaType="string"/>
		<result property="ACCOUNT_NUMBER" javaType="string"/>
		
		<result property="AKPK_FLAG" javaType="string"/>
		<result property="BLD" javaType="string"/>
		<result property="REFUND_OA_DEPOSIT" javaType="string"/>
		<result property="REFUND_COURT_DEPOSIT" javaType="string"/>
		<result property="DEBT_SALES" javaType="string"/>
		
		<result property="NEW_DISBURSEMENT" javaType="string"/>
		<result property="BANKRUPT" javaType="string"/>
		<result property="SHORTFALL" javaType="string"/>
		<result property="PENDING_BPP" javaType="string"/>
		<result property="AUCTION" javaType="string"/>
		
		<result property="AUCTION_RECEIVED_DEPOSIT" javaType="string"/>
		<result property="AUCTION_RECEIVED_BALANCE" javaType="string"/>
		<result property="EX_STAFF" javaType="string"/>
		<result property="DIBS" javaType="string"/>
		<result property="UNDER_CONSTRUCTION" javaType="string"/>
		
		<result property="EXTERNAL_COLLECTION_AGENCIES" javaType="string"/>
		<result property="RNR" javaType="string"/>
		<result property="WRITE_OFF" javaType="string"/>
		<result property="FRAUD" javaType="string"/>
		<result property="SETTLEMENT_PROPOSAL" javaType="string"/>
		
		<result property="SECURITY_DEPOSIT" javaType="string"/>
		<result property="ECA_MONITORING" javaType="string"/>
		<result property="LEGAL_MONITORING" javaType="string"/>
		<result property="ADMIN_MONITORING" javaType="string"/>
		<result property="MORATORIUM" javaType="string"/>
		
		<result property="REDEMPTION_STATEMENT" javaType="string"/>
		<result property="REPO" javaType="string"/>
		<result property="REPO_REDEEM" javaType="string"/>
		<result property="DECEASED" javaType="string"/>
		<result property="TPD" javaType="string"/>
		
		<result property="TPD_REJECTED" javaType="string"/>
		<result property="ABANDONED" javaType="string"/>
		<result property="EPF_WITHDRAWAL" javaType="string"/>
		<result property="COMPLAINT" javaType="string"/>
		<result property="EXCLUDE_ECA" javaType="string"/>
		
		<result property="EXCLUDE_LEGAL" javaType="string"/>
		<result property="VIP" javaType="string"/>		
		<result property="EXHAUSTED" javaType="string"/>
		<result property="ADMIN_ISSUE" javaType="string"/>
		<result property="UTC_ACCOUNTS" javaType="string"/>
		
		<result property="STAGGERED_PAYMENT" javaType="string"/>
		<result property="INVALID_CONTACT" javaType="string"/>
		<result property="SUBTYPE_ID" javaType="long"/>
	</resultMap>
	
	<select id="getMiscAccountTaggingData" resultMap="getMiscAccountTaggingData">
select
t.ID,
a.ID as ACCOUNT_ID,
c.CUSTOMER_NO,
c.CUSTOMER_NAME,
a.ACCOUNT_NO as ACCOUNT_NUMBER,
case when ta.akpk_flag=true then 'Yes' when ta.akpk_flag=false then 'No' end as AKPK_FLAG,
case when ta.bld then 'Yes' when ta.bld=false then 'No' end as BLD,
case when ta.refund_oa_deposit then 'Yes' when ta.refund_oa_deposit=false then 'No' end as REFUND_OA_DEPOSIT,
case when ta.refund_court_deposit then 'Yes' when ta.refund_court_deposit=false then 'No' end as REFUND_COURT_DEPOSIT,
case when ta.debt_sales then 'Yes' when ta.debt_sales=false then 'No' end as DEBT_SALES,
case when ta.new_disbursement then 'Yes' when ta.new_disbursement=false then 'No' end as NEW_DISBURSEMENT,
case when ta.bankrupt then 'Yes' when ta.bankrupt=false then 'No' end as BANKRUPT,
case when ta.shortfall then 'Yes' when ta.shortfall=false then 'No' end as SHORTFALL,
case when ta.pending_bpp then 'Yes' when ta.pending_bpp=false then 'No' end as PENDING_BPP,
case when ta.auction then 'Yes' when ta.auction=false then 'No' end as AUCTION,
case when ta.auction_received_deposit then 'Yes' when ta.auction_received_deposit=false then 'No' end as AUCTION_RECEIVED_DEPOSIT,
case when ta.auction_received_balance then 'Yes' when ta.auction_received_balance=false then 'No' end as AUCTION_RECEIVED_BALANCE,
case when ta.ex_staff then 'Yes' when ta.ex_staff=false then 'No' end as EX_STAFF,
case when ta.dibs then 'Yes' when ta.dibs=false then 'No' end as DIBS,
case when ta.under_construction then 'Yes' when ta.under_construction=false then 'No' end as UNDER_CONSTRUCTION,
case when ta.external_collection_agencies then 'Yes' when ta.external_collection_agencies=false then 'No' end as EXTERNAL_COLLECTION_AGENCIES,
case when ta.rnr then 'Yes' when ta.rnr=false then 'No' end as RNR,
case when ta.write_off then 'Yes' when ta.write_off=false then 'No' end as WRITE_OFF,
case when ta.fraud then 'Yes' when ta.fraud=false then 'No' end as FRAUD,
case when ta.settlement_proposal then 'Yes' when ta.settlement_proposal=false then 'No' end as SETTLEMENT_PROPOSAL,
case when ta.security_deposit then 'Yes' when ta.security_deposit=false then 'No' end as SECURITY_DEPOSIT,
case when ta.eca_monitoring then 'Yes' when ta.eca_monitoring=false then 'No' end as ECA_MONITORING,
case when ta.legal_monitoring then 'Yes' when ta.legal_monitoring=false then 'No' end as LEGAL_MONITORING,
case when ta.admin_monitoring then 'Yes' when ta.admin_monitoring=false then 'No' end as ADMIN_MONITORING,
case when ta.moratorium then 'Yes' when ta.moratorium=false then 'No' end as MORATORIUM,
case when ta.redemption_statement then 'Yes' when ta.redemption_statement=false then 'No' end as REDEMPTION_STATEMENT,
case when ta.repo then 'Yes' when ta.repo=false then 'No' end as REPO,
case when ta.repo_redeem then 'Yes' when ta.repo_redeem=false then 'No' end as REPO_REDEEM,
case when ta.deceased then 'Yes' when ta.deceased=false then 'No' end as DECEASED,
case when ta.tpd then 'Yes' when ta.tpd=false then 'No' end as TPD,
case when ta.tpd_rejected then 'Yes' when ta.tpd_rejected=false then 'No' end as TPD_REJECTED,
case when ta.abandoned then 'Yes' when ta.abandoned=false then 'No' end as ABANDONED,
case when ta.epf_withdrawal then 'Yes' when ta.epf_withdrawal=false then 'No' end as EPF_WITHDRAWAL,
NULL as COMPLAINT,
NULL as EXCLUDE_ECA,
NULL as EXCLUDE_LEGAL,
NULL as VIP,
NULL as EXHAUSTED,
NULL as ADMIN_ISSUE,
NULL as UTC_ACCOUNTS,
NULL as STAGGERED_PAYMENT,
case when ta.INVALID_CONTACT then 'Yes' when ta.INVALID_CONTACT=false then 'No' end as INVALID_CONTACT,
t.SUBTYPE_ID
from PTRACCOUNT a
inner join ptrcustomer c on c.id=a.customer_id
inner join ptrtreatment t on t.account_id=a.id
inner join ptrtreatment_account_tagging ta on ta.treatment_id=t.id
<iterate open="(" close=")" prepend="where a.id in" conjunction="," property="ACCOUNTS">#ACCOUNTS[]#</iterate>
and t.status_id=15007
	</select>
	
	<resultMap class="hmap" id="getMiscAccountTaggingDataBoolean">
	<result property="ID" javaType="long"/>
		<result property="ACCOUNT_ID" javaType="long"/>
		<result property="CUSTOMER_NO" javaType="string"/>
		<result property="CUSTOMER_NAME" javaType="string"/>
		<result property="ACCOUNT_NUMBER" javaType="string"/>
		
		<result property="AKPK" javaType="boolean"/>
		<result property="BLD" javaType="boolean"/>
		<result property="REFUND_OA_DEPOSIT" javaType="boolean"/>
		<result property="REFUND_COURT_DEPOSIT" javaType="boolean"/>
		<result property="DEBT_SALES" javaType="boolean"/>
		
		<result property="NEW_DISBURSEMENT" javaType="boolean"/>
		<result property="BANKRUPT" javaType="boolean"/>
		<result property="SHORTFALL" javaType="boolean"/>
		<result property="PENDING_BPP" javaType="boolean"/>
		<result property="AUCTION" javaType="boolean"/>
		
		<result property="AUCTION_RECEIVED_DEPOSIT" javaType="boolean"/>
		<result property="AUCTION_RECEIVED_BALANCE" javaType="boolean"/>
		<result property="EX_STAFF" javaType="boolean"/>
		<result property="DIBS" javaType="boolean"/>
		<result property="UNDER_CONSTRUCTION" javaType="boolean"/>
		
		<result property="EXTERNAL_COLLECTION_AGENCIES" javaType="boolean"/>
		<result property="RNR" javaType="boolean"/>
		<result property="WRITE_OFF" javaType="boolean"/>
		<result property="FRAUD" javaType="boolean"/>
		<result property="SETTLEMENT_PROPOSAL" javaType="boolean"/>
		
		<result property="SECURITY_DEPOSIT" javaType="boolean"/>
		<result property="ECA_MONITORING" javaType="boolean"/>
		<result property="LEGAL_MONITORING" javaType="boolean"/>
		<result property="ADMIN_MONITORING" javaType="boolean"/>
		<result property="MORATORIUM" javaType="boolean"/>
		
		<result property="REDEMPTION_STATEMENT" javaType="boolean"/>
		<result property="REPO" javaType="boolean"/>
		<result property="REPO_REDEEM" javaType="boolean"/>
		<result property="DECEASED" javaType="boolean"/>
		<result property="TPD" javaType="boolean"/>
		
		<result property="TPD_REJECTED" javaType="boolean"/>
		<result property="ABANDONED" javaType="boolean"/>
		<result property="EPF_WITHDRAWAL" javaType="boolean"/>
		<result property="COMPLAINT" javaType="boolean"/>
		<result property="EXCLUDE_ECA" javaType="boolean"/>
		
		<result property="EXCLUDE_LEGAL" javaType="boolean"/>
		<result property="VIP" javaType="boolean"/>		
		<result property="EXHAUSTED" javaType="boolean"/>
		<result property="ADMIN_ISSUE" javaType="boolean"/>
		<result property="UTC_ACCOUNTS" javaType="boolean"/>
		
		<result property="STAGGERED_PAYMENT" javaType="boolean"/>
		<result property="INVALID_CONTACT" javaType="boolean"/>
		<result property="SUBTYPE_ID" javaType="long"/>
	</resultMap>
	
	<select id="getMiscAccountTaggingDataBoolean" resultMap="getMiscAccountTaggingDataBoolean">
select
t.ID,
a.ID as ACCOUNT_ID,
c.CUSTOMER_NO,
c.CUSTOMER_NAME,
a.ACCOUNT_NO as ACCOUNT_NUMBER,
ta.akpk_flag as AKPK_FLAG,
ta.bld as BLD,
ta.refund_oa_deposit as REFUND_OA_DEPOSIT,
ta.refund_court_deposit as REFUND_COURT_DEPOSIT,
ta.debt_sales as DEBT_SALES,
ta.new_disbursement as NEW_DISBURSEMENT,
ta.bankrupt as BANKRUPT,
ta.shortfall as SHORTFALL,
ta.pending_bpp as PENDING_BPP,
ta.auction as AUCTION,
ta.auction_received_deposit as AUCTION_RECEIVED_DEPOSIT,
ta.auction_received_balance as AUCTION_RECEIVED_BALANCE,
ta.ex_staff as EX_STAFF,
ta.dibs as DIBS,
ta.under_construction as UNDER_CONSTRUCTION,
ta.external_collection_agencies as EXTERNAL_COLLECTION_AGENCIES,
ta.rnr as RNR,
ta.write_off as WRITE_OFF,
ta.fraud as FRAUD,
ta.settlement_proposal as SETTLEMENT_PROPOSAL,
ta.security_deposit as SECURITY_DEPOSIT,
ta.eca_monitoring as ECA_MONITORING,
ta.legal_monitoring as LEGAL_MONITORING,
ta.admin_monitoring as ADMIN_MONITORING,
ta.moratorium as MORATORIUM,
ta.redemption_statement as REDEMPTION_STATEMENT,
ta.repo as REPO,
ta.repo_redeem as REPO_REDEEM,
ta.deceased as DECEASED,
ta.tpd as TPD,
ta.tpd_rejected as TPD_REJECTED,
ta.abandoned as ABANDONED,
ta.epf_withdrawal as EPF_WITHDRAWAL,
NULL as COMPLAINT,
NULL as EXCLUDE_ECA,
NULL as EXCLUDE_LEGAL,
NULL as VIP,
NULL as EXHAUSTED,
NULL as ADMIN_ISSUE,
NULL as UTC_ACCOUNTS,
NULL as STAGGERED_PAYMENT,
ta.INVALID_CONTACT,
t.SUBTYPE_ID
from PTRACCOUNT a
inner join ptrcustomer c on c.id=a.customer_id
inner join ptrtreatment t on t.account_id=a.id
inner join ptrtreatment_account_tagging ta on ta.treatment_id=t.id
<iterate open="(" close=")" prepend="where a.id in" conjunction="," property="ACCOUNTS">#ACCOUNTS[]#</iterate>
and t.status_id=15007
	</select>
	
	<resultMap class="hmap" id="getMiscAccountTaggingTypeStatus" extends="global.ref">
	<result property="STATUS_ID" javaType="long"/>
	</resultMap>
	
	<select id="getMiscAccountTaggingTypeStatus" resultMap="getMiscAccountTaggingTypeStatus">
	<include refid="pleaseSelectRef"/>, NULL <include refid="fromdual"/> union
	<include refid="refselect"/>, STATUS_ID from PTRTREATMENT_TYPE_STATUS_REF where TYPE_ID=56 and CODE in ('AT_REJ','AT_APP')
	</select>

<resultMap class="hmap" id="getTreatmentAccountTagging">
<result property="ACCOUNT_ID" javaType="long"/>

<result property="AKPK_FLAG" javaType="boolean"/>
<result property="BLD" javaType="boolean"/>
<result property="REFUND_OA_DEPOSIT" javaType="boolean"/>
<result property="DEBT_SALES" javaType="boolean"/>
<result property="NEW_DISBURSEMENT" javaType="boolean"/>

<result property="BANKRUPT" javaType="boolean"/>
<result property="SHORTFALL" javaType="boolean"/>
<result property="PENDING_BPP" javaType="boolean"/>
<result property="AUCTION" javaType="boolean"/>
<result property="AUCTION_RECEIVED_DEPOSIT" javaType="boolean"/>

<result property="AUCTION_RECEIVED_BALANCE" javaType="boolean"/>
<result property="EX_STAFF" javaType="boolean"/>
<result property="DIBS" javaType="boolean"/>
<result property="UNDER_CONSTRUCTION" javaType="boolean"/>
<result property="EXTERNAL_COLLECTION_AGENCIES" javaType="boolean"/>

<result property="RNR" javaType="boolean"/>
<result property="WRITE_OFF" javaType="boolean"/>
<result property="FRAUD" javaType="boolean"/>
<result property="SETTLEMENT_PROPOSAL" javaType="boolean"/>
<result property="SECURITY_DEPOSIT" javaType="boolean"/>

<result property="ECA_MONITORING" javaType="boolean"/>
<result property="LEGAL_MONITORING" javaType="boolean"/>
<result property="ADMIN_MONITORING" javaType="boolean"/>
<result property="MORATORIUM" javaType="boolean"/>
<result property="REDEMPTION_STATEMENT" javaType="boolean"/>

<result property="REPO" javaType="boolean"/>
<result property="REPO_REDEEM" javaType="boolean"/>
<result property="ABANDONED" javaType="boolean"/>
<result property="EPF_WITHDRAWAL" javaType="boolean"/>
<result property="REFUND_COURT_DEPOSIT" javaType="boolean"/>

<result property="TPD" javaType="boolean"/>
<result property="TPD_REJECTED" javaType="boolean"/>
<result property="DECEASED" javaType="boolean"/>
<result property="INVALID_CONTACT" javaType="boolean"/>
</resultMap>

<select id="getTreatmentAccountTagging" resultMap="getTreatmentAccountTagging">
select account_id, 
akpk_flag, bld, refund_oa_deposit, debt_sales, new_disbursement, 
bankrupt, shortfall, pending_bpp, auction, auction_received_deposit, 
auction_received_balance, ex_staff, dibs, under_construction, external_collection_agencies, 
rnr, write_off, fraud, settlement_proposal, security_deposit, 
eca_monitoring, legal_monitoring, admin_monitoring, moratorium, redemption_statement, 
repo, repo_redeem, abandoned, epf_withdrawal, refund_court_deposit, 
tpd, tpd_rejected, deceased, invalid_contact 
from ptraccount_treatment_tagging 
where account_id=#ACCOUNT_ID#
</select>

<delete id="deleteTreatmentAccountTaggingRel" parameterClass="map">
delete from ptraccount_tagging_rel where ACCOUNT_ID=#ACCOUNT_ID#
</delete>

<insert id="insertTreatmentAccountTaggingRel" parameterClass="map">
insert into ptraccount_tagging_rel (ACCOUNT_ID, ACCOUNT_TAGGING_ID)
values (#ACCOUNT_ID#, #ACCOUNT_TAGGING_ID#)
</insert>

<resultMap class="hmap" id="getAccountTaggingId">
<result property="ACCOUNT_TAGGING_ID" javaType="long"/>
<result property="CODE" javaType="string"/>
</resultMap>

<sql id="getAccountTaggingId-fragments">
select ID, CODE from PTRACCOUNT_TAGGING_REF where CODE=#CODE#
</sql>

<select id="getAccountTaggingId" resultMap="getAccountTaggingId">
<include refid="getAccountTaggingId-fragments"/>
</select>


	
</sqlMap>