<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<event transactional="false" type="event">
 <exec ceiling="false" endmonth="false" nextweekday="false" startmonth="true" to="FIRST_OF_MONTH" truncate="false" type="date"/>
 <exec ceiling="false" endmonth="true" nextweekday="false" startmonth="false" truncate="false" type="date"/>
 <exec type="guard">
  <conditions>
   <condition lhsfield="WLT_CODE" operator="=" rhsvalue="openAgency"/>
  </conditions>
  <exec argument="ACCOUNT_LIST" query="getAgencyWorkListOpenAccounts" type="query"/>
  <exec event="wlt.getAgencyPaidAccounts" ignoreresult="true" type="raise"/>
  <exec key="ACCOUNT_ID" minuend="ACCOUNT_LIST" subtrahend="PAID_ACCOUNT_ID_LIST" to="ACCOUNT_LIST" type="remove"/>
 </exec>
 <exec type="guard">
  <conditions>
   <condition lhsfield="WLT_CODE" operator="=" rhsvalue="brokenPromiseAgency"/>
  </conditions>
  <exec argument="ACCOUNT_LIST" query="getAgencyWorkListBrokenPromiseAccounts" type="query"/>
  <exec event="wlt.getAgencyPaidAccounts" ignoreresult="true" type="raise"/>
  <exec key="ACCOUNT_ID" minuend="ACCOUNT_LIST" subtrahend="PAID_ACCOUNT_ID_LIST" to="ACCOUNT_LIST" type="remove"/>
 </exec>
 <exec type="guard">
  <conditions>
   <condition lhsfield="WLT_CODE" operator="=" rhsvalue="pendingAgency"/>
  </conditions>
  <exec argument="ACCOUNT_LIST" query="getAgencyWorkListPendingAbortAccounts" type="query"/>
  <exec event="wlt.getAgencyPaidAccounts" ignoreresult="true" type="raise"/>
  <exec key="ACCOUNT_ID" minuend="ACCOUNT_LIST" subtrahend="PAID_ACCOUNT_ID_LIST" to="ACCOUNT_LIST" type="remove"/>
 </exec>
 <exec type="guard">
  <conditions>
   <condition lhsfield="WLT_CODE" operator="=" rhsvalue="lostContactAgency"/>
  </conditions>
  <exec argument="ACCOUNT_LIST" query="getAgencyWorkListLostContactAccounts" type="query"/>
  <exec event="wlt.getAgencyPaidAccounts" ignoreresult="true" type="raise"/>
  <exec key="ACCOUNT_ID" minuend="ACCOUNT_LIST" subtrahend="PAID_ACCOUNT_ID_LIST" to="ACCOUNT_LIST" type="remove"/>
 </exec>
 <exec type="guard">
  <conditions>
   <condition lhsfield="WLT_CODE" operator="=" rhsvalue="ptpAgency"/>
  </conditions>
  <exec argument="ACCOUNT_LIST" query="getAgencyWorkListPtpAccounts" type="query"/>
  <exec event="wlt.getAgencyPaidAccounts" ignoreresult="true" type="raise"/>
  <exec key="ACCOUNT_ID" minuend="ACCOUNT_LIST" subtrahend="PAID_ACCOUNT_ID_LIST" to="ACCOUNT_LIST" type="remove"/>
 </exec>
 <exec type="guard">
  <conditions>
   <condition lhsfield="WLT_CODE" operator="=" rhsvalue="paidAgency"/>
  </conditions>
  <exec event="wlt.getAgencyPaidAccounts" ignoreresult="true" type="raise"/>
  <exec from="PAID_ACCOUNT_ID_LIST" key="ACCOUNT_ID" to="PAID_ACCOUNTS" type="extract"/>
  <exec argument="ACCOUNT_LIST" query="getAgencyWorkListPaidAccounts" type="query"/>
 </exec>
 <exec argument="LAST_PAYMENT_LIST" query="getLatestPaymentAmtForAgencyWorkList" type="query"/>
 <exec from="LAST_PAYMENT_LIST" key="ACCOUNT_ID" to="ACCOUNT_LIST" type="merge"/>
 <exec from="ACCOUNT_LIST" type="copy"/>
</event>
